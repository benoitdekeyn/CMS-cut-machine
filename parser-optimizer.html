<!doctype html><html lang="fr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>CutOptimizer - Optimisation de d√©coupe</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"><link rel="stylesheet" href="css/style.css"><style type="text/css">/* Base styles and variables */
:root {
  --primary: #2563eb;
  --primary-light: #3b82f6;
  --primary-dark: #1d4ed8;
  --success: #10b981;
  --danger: #ef4444;
  --warning: #f59e0b;
  --gray-50: #f9fafb;
  --gray-100: #f3f4f6;
  --gray-200: #e5e7eb;
  --gray-300: #d1d5db;
  --gray-400: #9ca3af;
  --gray-500: #6b7280;
  --gray-600: #4b5563;
  --gray-700: #374151;
  --gray-800: #1f2937;
  --gray-900: #111827;
  --border-radius: 0.375rem;
  --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
  --shadow: 0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06);
  --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
  --transition: all 0.2s ease;
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: 'Inter', sans-serif;
  color: var(--gray-800);
  line-height: 1.5;
  background-color: var(--gray-50);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Layout */
.app-container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
}

.hidden {
  display: none !important;
}

/* Typography */
h1, h2, h3, h4 {
  color: var(--gray-800);
  font-weight: 600;
}

h1 {
  font-size: 1.875rem;
  margin: 0;
}

h2 {
  font-size: 1.5rem;
  margin-bottom: 1.5rem;
}

h3 {
  font-size: 1.25rem;
  margin-bottom: 0.75rem;
}

h4 {
  font-size: 1rem;
  margin-bottom: 0.5rem;
}

.info-text {
  color: var(--gray-500);
  font-size: 0.75rem;
  font-style: italic;
}

.text-center {
  text-align: center;
}

/* Spacing utilities */
.mb-1 { margin-bottom: 0.25rem; }
.mb-2 { margin-bottom: 0.5rem; }
.mb-3 { margin-bottom: 0.75rem; }
.mb-4 { margin-bottom: 1rem; }

/* Header and Navigation */
.main-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 2rem;
}

.main-nav {
  display: flex;
  gap: 1rem;
}

.nav-btn {
  padding: 0.5rem 1rem;
  background: transparent;
  border: none;
  color: var(--gray-500);
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  border-bottom: 2px solid transparent;
  transition: var(--transition);
}

.nav-btn.active {
  color: var(--primary);
  border-bottom-color: var(--primary);
}

/* Content sections */
.main-content {
  min-height: 600px;
}

.content-section {
  display: none;
}

.content-section.active {
  display: block;
}

.section-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 1.5rem;
}

.section-actions {
  display: flex;
  gap: 0.5rem;
}

/* Panels */
.panels-container {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
  gap: 1.5rem;
  margin-bottom: 2rem;
}

.panel {
  background: white;
  border-radius: var(--border-radius);
  box-shadow: var(--shadow-sm);
  overflow: hidden;
}

.panel-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem;
  background-color: var(--gray-50);
  border-bottom: 1px solid var(--gray-200);
}

.panel-content {
  padding: 1rem;
  overflow-x: auto;
}

/* Buttons */
.btn, button {
  cursor: pointer;
  border: none;
  font-weight: 500;
  transition: var(--transition);
  border-radius: var(--border-radius);
}

.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0.5rem 1rem;
  font-size: 0.875rem;
  line-height: 1.25rem;
  background-color: white;
}

.btn-sm {
  padding: 0.25rem 0.5rem;
  font-size: 0.75rem;
}

.btn-primary, .primary-btn {
  background-color: var(--primary);
  color: white;
}

.btn-primary:hover, .primary-btn:hover {
  background-color: var(--primary-dark);
}

.btn-outline {
  border: 1px solid var(--gray-300);
}

.btn-outline:hover {
  background-color: var(--gray-100);
}

.btn-success {
  background-color: var(--success);
  color: white;
}

.btn-success:hover {
  background-color: #0ca678;
}

.btn-danger {
  background-color: var(--danger);
  color: white;
}

.btn-danger:hover {
  filter: brightness(90%);
}

.action-buttons {
  display: flex;
  gap: 0.25rem;
  justify-content: flex-end;
}

/* Tables */
.data-table {
  width: 100%;
  border-collapse: collapse;
}

.data-table th {
  text-align: left;
  padding: 0.75rem 1rem;
  font-weight: 500;
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--gray-500);
  background-color: var(--gray-50);
  border-bottom: 1px solid var(--gray-200);
}

.data-table td {
  padding: 0.75rem 1rem;
  font-size: 0.875rem;
  border-bottom: 1px solid var(--gray-200);
}

.data-table tbody tr:last-child td {
  border-bottom: none;
}

.data-table tbody tr:hover {
  background-color: var(--gray-50);
}

.data-table .delete-cell {
  width: 40px;
  text-align: center;
}

/* Editable table */
.editable-table .editable-cell {
  cursor: pointer;
  transition: var(--transition);
}

.editable-table .editable-cell:hover {
  background-color: var(--primary-light);
  color: white;
}

.editable-table .editing {
  padding: 0;
}

.editable-table .editing input {
  width: 100%;
  padding: 0.75rem 1rem;
  border: none;
  background-color: var(--primary-light);
  color: white;
  font-size: 0.875rem;
  font-family: inherit;
}

.editable-table .editing input:focus {
  outline: none;
}

.add-row input {
  width: 100%;
  padding: 0.5rem;
  border: 1px solid var(--gray-300);
  border-radius: var(--border-radius);
  font-size: 0.875rem;
  font-family: inherit;
}

.add-row input:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
}

/* Algorithm cards */
#algorithm-selection {
  margin: 20px 0;
}

.algorithm-cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 1rem;
  margin-top: 1rem;
}

.algorithm-card {
  background-color: white;
  border-radius: var(--border-radius);
  box-shadow: var(--shadow);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  height: 100%;
  transition: var(--transition);
  padding: 20px;
  border: 1px solid #ddd;
}

.algorithm-card:hover {
  box-shadow: var(--shadow-md);
  transform: translateY(-2px);
}

.algorithm-card h3 {
  color: #2c3e50;
  margin-bottom: 15px;
  border-bottom: 1px solid #eee;
  padding-bottom: 10px;
}

.algo-description {
  color: var(--gray-600);
  font-size: 0.875rem;
  line-height: 1.5;
  flex-grow: 1;
  margin-bottom: 20px;
}

.algo-description p {
  margin-bottom: 10px;
}

.algo-btn {
  width: 100%;
  margin-top: 10px;
}

/* Modal dialog */
.modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}

.modal-content {
  background-color: white;
  border-radius: var(--border-radius);
  width: 90%;
  max-width: 500px;
  box-shadow: var(--shadow-lg);
}

.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem 1.5rem;
  border-bottom: 1px solid var(--gray-200);
}

.close-modal {
  background: none;
  border: none;
  font-size: 1.5rem;
  cursor: pointer;
  color: var(--gray-500);
}

.modal-body {
  padding: 1.5rem;
}

.modal-footer {
  display: flex;
  justify-content: flex-end;
  gap: 0.5rem;
  padding: 1rem 1.5rem;
  border-top: 1px solid var(--gray-200);
}

/* File drop zone */
.file-drop-zone {
  position: relative;
  border: 2px dashed var(--gray-300);
  border-radius: var(--border-radius);
  padding: 2rem;
  text-align: center;
  transition: var(--transition);
  margin: 1rem 0;
}

.file-drop-zone:hover {
  border-color: var(--primary);
}

.file-input {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  opacity: 0;
  cursor: pointer;
}

.file-label {
  display: flex;
  flex-direction: column;
  align-items: center;
  color: var(--gray-500);
}

.file-icon {
  font-size: 2rem;
  margin-bottom: 0.5rem;
}

.file-prompt {
  font-size: 0.875rem;
}

.file-name {
  font-weight: 500;
  color: var(--primary);
  margin-top: 0.5rem;
  display: none;
}

.file-name.active {
  display: block;
}

/* CSV format example */
.csv-format-example {
  margin-top: 15px;
  padding: 10px;
  background-color: var(--gray-50);
  border: 1px dashed var(--gray-300);
  border-radius: var(--border-radius);
}

.csv-format-example pre {
  margin: 10px 0;
  padding: 8px;
  background-color: white;
  border-radius: var(--border-radius);
  overflow-x: auto;
  font-size: 0.8rem;
}

.csv-format-example code {
  font-family: 'Menlo', 'Monaco', 'Courier New', monospace;
}

/* Results visualization */
.tag {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0.25rem 0.75rem;
  font-size: 0.75rem;
  font-weight: 500;
  background-color: var(--gray-100);
  color: var(--gray-600);
  border-radius: 9999px;
}

.no-results-message {
  background-color: white;
  padding: 2rem;
  text-align: center;
  border-radius: var(--border-radius);
  color: var(--gray-500);
  font-style: italic;
}

.results-summary {
  background-color: white;
  border-radius: var(--border-radius);
  padding: 1.5rem;
  margin-bottom: 1.5rem;
  box-shadow: var(--shadow-sm);
}

.results-summary h3 {
  font-size: 1.25rem;
  font-weight: 600;
  margin-bottom: 1rem;
  color: var(--gray-800);
}

.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1rem;
  margin-top: 1rem;
}

.stat-card {
  background-color: var(--gray-50);
  padding: 1rem;
  border-radius: var(--border-radius);
  border: 1px solid var(--gray-200);
}

.stat-card.efficiency-card {
  background-color: #e6f7e6;
}

.stat-card.efficiency-card .stat-label,
.stat-card.efficiency-card .stat-value {
  color: #2e7d32;
  font-weight: bold;
}

.stat-card .stat-label {
  font-size: 0.75rem;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--gray-500);
  background-color: var(--gray-100);
  padding: 0.5rem;
  border-radius: 4px;
}

.stat-card .stat-value {
  font-size: 1.5rem;
  font-weight: 600;
  color: var(--gray-800);
}

/* Model results */
.model-results {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
  gap: 1.5rem;
  margin-top: 1.5rem;
}

.model-card {
  background-color: white;
  border-radius: var(--border-radius);
  overflow: hidden;
  box-shadow: var(--shadow-sm);
  width: 100%;
  border: 1px solid var(--gray-300);
}

.model-header {
  background-color: var(--gray-100);
  padding: 1rem 1.5rem;
  border-bottom: 2px solid var(--primary-light);
}

.model-content {
  padding: 1.5rem;
}

.model-stats {
  display: flex;
  justify-content: space-between;
  margin-bottom: 1rem;
}

.model-stat {
  text-align: center;
}

.model-stat .stat-label {
  font-size: 0.75rem;
  color: var(--gray-500);
}

.model-stat .stat-value {
  font-size: 1.25rem;
  font-weight: 600;
  color: var(--gray-800);
}

.efficiency-tag {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0.25rem 0.75rem;
  font-size: 0.875rem;
  font-weight: 500;
  background-color: #e8f5e9;
  color: #2e7d32;
  border-radius: 9999px;
}

/* Cut schemes */
.cut-schemes {
  margin-top: 1.5rem;
}

.cut-scheme {
  background-color: white;
  padding: 1rem;
  border-radius: var(--border-radius);
  margin-bottom: 1rem;
  border: 1px solid var(--gray-200);
  box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  font-size: 1.12em;
}

.cut-scheme-header {
  display: flex;
  justify-content: space-between;
  margin-bottom: 0.75rem;
}

.cut-pieces {
  margin: 0.5rem 0;
}

.cut-bar {
  display: flex;
  height: 30px;
  background-color: var(--gray-200);
  border-radius: var(--border-radius);
  overflow: hidden;
  margin-top: 0.5rem;
}

.cut-piece {
  background-color: var(--primary-light);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.75rem;
  border-right: 2px solid white;
}

.cut-piece.last-piece {
  border-right: none;
}

.waste-piece {
  background-color: var(--danger);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.75rem;
}

.cut-count {
  color: #777;
  font-size: 0.85em;
  margin-right: 2px;
}

.waste-value {
  background-color: #ffebee;
  color: #e53935;
  border-radius: 30px;
  padding: 1px 6px;
  display: inline-block;
  border: 1px solid #ffcdd2;
  font-size: 1em;
}

/* Error and message styles */
.error-message {
  background-color: #fdecea;
  border-left: 4px solid #e74c3c;
  padding: 15px;
  margin: 20px 0;
  border-radius: 4px;
}

.warning {
  background-color: #fff3cd;
  color: #856404;
  padding: 10px 15px;
  border-radius: 4px;
  border-left: 4px solid #ffeeba;
  margin: 10px 0;
  font-weight: 500;
}

.success {
  background-color: #d4edda;
  color: #155724;
  padding: 10px 15px;
  border-radius: 4px;
  border-left: 4px solid #c3e6cb;
  margin: 10px 0;
  font-weight: 500;
}

/* Algorithm comparison */
.algorithm-comparison {
  background-color: var(--gray-50);
  border-radius: var(--border-radius);
  padding: 1rem;
  margin-bottom: 1.5rem;
  border: 1px solid var(--gray-200);
}

.comparison-result {
  font-size: 1.1rem;
  margin-bottom: 0.75rem;
}

.algorithm-efficiencies {
  display: flex;
  gap: 1rem;
  margin: 1rem 0;
}

.efficiency-comparison {
  flex: 1;
  padding: 0.75rem;
  border-radius: var(--border-radius);
  background-color: white;
  border: 1px solid var(--gray-200);
  text-align: center;
}

.efficiency-comparison.best {
  background-color: #e6f7e6;
  border-color: var(--success);
}

.algorithm-name {
  font-weight: 500;
  margin-bottom: 0.5rem;
}

.efficiency-value {
  font-size: 1.5rem;
  font-weight: 600;
  color: var(--gray-800);
}

.efficiency-comparison.best .efficiency-value {
  color: var(--success);
}

.difference-info {
  font-size: 0.9rem;
  color: var(--gray-600);
  text-align: center;
}

/* Optimization actions */
.optimization-actions {
  background: white;
  border-radius: var(--border-radius);
  padding: 1.5rem;
  margin-top: 1.5rem;
  box-shadow: var(--shadow-sm);
}

.optimization-actions h3 {
  font-size: 1.25rem;
  font-weight: 600;
  margin-bottom: 0.75rem;
  color: var(--gray-800);
}

.optimization-actions p {
  color: var(--gray-600);
  margin-bottom: 1rem;
  font-size: 0.9rem;
}

.algorithm-buttons {
  display: flex;
  flex-wrap: wrap;
  gap: 1rem;
  margin-top: 1rem;
}

.algorithm-buttons .btn {
  flex: 1;
  min-width: 200px;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 1rem;
  text-align: center;
}

/* Loading indicator */
.loading-indicator {
  display: flex;
  flex-direction: column;
  align-items: center;
  margin: 40px 0;
}

.spinner {
  border: 4px solid rgba(0, 0, 0, 0.1);
  width: 36px;
  height: 36px;
  border-radius: 50%;
  border-left-color: #3498db;
  animation: spin 1s linear infinite;
  margin-bottom: 15px;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/* Utils */
.text-center {
  text-align: center;
}

.mb-1 {
  margin-bottom: 0.25rem;
}

.mb-2 {
  margin-bottom: 0.5rem;
}

.mb-3 {
  margin-bottom: 0.75rem;
}

.mb-4 {
  margin-bottom: 1rem;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .app-container {
        padding: 1rem;
    }
    
    .panels-container {
        grid-template-columns: 1fr;
    }
    
    .algorithm-cards {
        grid-template-columns: 1fr;
    }
    
    .model-results {
        grid-template-columns: 1fr;
    }
}
</style></head><body><div class="app-container"><header class="main-header"><div class="logo"><h1>CutOptimizer</h1></div><nav class="main-nav"><button class="nav-btn active" data-section="data-section">Donn√©es</button> <button class="nav-btn" data-section="result-section">R√©sultats</button></nav></header><main class="main-content"><section id="data-section" class="content-section active"><div class="section-header"><h2>Donn√©es d'entr√©e</h2><div class="section-actions"><button id="import-btn" class="btn btn-outline">Importer CSV</button> <input type="file" id="csv-upload" accept=".csv" class="hidden"></div></div><div class="panels-container"><div class="panel"><div class="panel-header"><h3>Barres m√®res</h3><div class="panel-actions"><button id="add-stock-bar-btn" class="btn btn-sm">+ Ajouter</button></div></div><div class="panel-content"><table id="stock-bars-table" class="data-table editable-table"><thead><tr><th>Mod√®le</th><th>Longueur</th><th>Quantit√©</th><th></th></tr></thead><tbody></tbody><tfoot><tr id="add-stock-bar-row" class="add-row hidden"><td><input id="new-stock-model" placeholder="Mod√®le"></td><td><input type="number" id="new-stock-length" placeholder="Longueur"></td><td><input type="number" id="new-stock-quantity" placeholder="Quantit√©" value="100000"></td><td><div class="action-buttons"><button id="confirm-add-stock" class="btn btn-sm btn-success">‚úì</button> <button id="cancel-add-stock" class="btn btn-sm btn-danger">‚úó</button></div></td></tr></tfoot></table></div></div><div class="panel"><div class="panel-header"><h3>Pi√®ces √† d√©couper</h3><div class="panel-actions"><button id="add-piece-btn" class="btn btn-sm">+ Ajouter</button></div></div><div class="panel-content"><table id="pieces-table" class="data-table editable-table"><thead><tr><th>Mod√®le</th><th>Longueur</th><th>Quantit√©</th><th></th></tr></thead><tbody></tbody><tfoot><tr id="add-piece-row" class="add-row hidden"><td><input id="new-piece-model" placeholder="Mod√®le"></td><td><input type="number" id="new-piece-length" placeholder="Longueur"></td><td><input type="number" id="new-piece-quantity" placeholder="Quantit√©" value="1"></td><td><div class="action-buttons"><button id="confirm-add-piece" class="btn btn-sm btn-success">‚úì</button> <button id="cancel-add-piece" class="btn btn-sm btn-danger">‚úó</button></div></td></tr></tfoot></table></div></div></div><div class="optimization-actions"><h3>Lancer l'optimisation</h3><p>Choisissez un algorithme d'optimisation ou lancez les deux pour comparer les r√©sultats.</p><div class="algorithm-buttons"><button id="run-ffd-btn" class="btn btn-primary"><span class="algorithm-name">First-Fit Decreasing</span> <span class="algorithm-desc">Rapide et efficace pour des cas simples</span></button> <button id="run-ilp-btn" class="btn btn-primary"><span class="algorithm-name">Programmation Lin√©aire (ILP)</span> <span class="algorithm-desc">Solution optimale mais plus lent</span></button> <button id="run-compare-btn" class="btn btn-success"><span class="algorithm-name">Comparer les deux</span> <span class="algorithm-desc">Lancer les deux et garder le meilleur</span></button></div></div></section><section id="result-section" class="content-section"><div class="section-header"><h2>R√©sultats</h2><div class="section-actions"><span id="result-algorithm" class="tag">Aucun calcul effectu√©</span></div></div><div id="results-container"><div class="no-results-message"><p>Aucun r√©sultat disponible. Veuillez ex√©cuter un algorithme d'optimisation.</p></div></div></section></main><div id="import-modal" class="modal hidden"><div class="modal-content"><div class="modal-header"><h3>Importer un fichier CSV</h3><button class="close-modal">&times;</button></div><div class="modal-body"><p>S√©lectionnez un fichier CSV contenant vos donn√©es de barres m√®res et pi√®ces.</p><div class="file-drop-zone"><input type="file" id="csv-file-input" accept=".csv" class="file-input"> <label for="csv-file-input" class="file-label"><span class="file-icon">üìÑ</span> <span class="file-prompt">Glisser un fichier ou cliquer pour s√©lectionner</span> <span class="file-name"></span></label></div><div class="csv-format-example"><h4>Format attendu:</h4><pre><code>type,modele,longueur,quantite
mere,ALU,6000,10
mere,ALU,3000,15
fille,ALU,2500,5
fille,ALU,1800,3</code></pre><p class="info-text">Les colonnes doivent √™tre: type (mere/fille), mod√®le, longueur, quantit√©</p></div></div><div class="modal-footer"><button id="confirm-import" class="btn btn-primary">Importer</button> <button class="btn btn-outline close-modal">Annuler</button></div></div></div></div><div id="loading-overlay" class="hidden"><div class="spinner"></div><p>Calcul en cours...</p></div><script src="js/algorithms/First-Fit-Decreasing.js"></script><script src="js/algorithms/Integer-Linear-Programming.js"></script><script src="js/data-manager.js"></script><script src="js/algorithm-service.js"></script><script src="js/results-renderer.js"></script><script src="js/ui-controller.js"></script><script src="js/index.js"></script><script defer="defer">(()=>{var t={38:(t,e,i)=>{var n=i(442);function s(t,e){this.index=t,this.value=e}n.prototype.getMostFractionalVar=function(){for(var t=0,e=null,i=null,n=this.model.integerVariables,a=n.length,r=0;r<a;r++){var o=n[r].index,l=this.rowByVarIndex[o];if(-1!==l){var h=this.matrix[l][this.rhsColumn],c=Math.abs(h-Math.round(h));t<c&&(t=c,e=o,i=h)}}return new s(e,i)},n.prototype.getFractionalVarWithLowestCost=function(){for(var t=1/0,e=null,i=null,n=this.model.integerVariables,a=n.length,r=0;r<a;r++){var o=n[r],l=o.index,h=this.rowByVarIndex[l];if(-1!==h){var c=this.matrix[h][this.rhsColumn];if(Math.abs(c-Math.round(c))>this.precision){var d=o.cost;t>d&&(t=d,e=l,i=c)}}}return new s(e,i)}},61:(t,e,i)=>{var n,s=i(871),a=i(487),r=i(184),o=i(773),l=i(363),h=o.Constraint,c=o.Variable,d=o.Numeral,u=o.Term,p=i(791),g=function(){"use strict";this.Model=a,this.branchAndCut=r,this.Constraint=h,this.Variable=c,this.Numeral=d,this.Term=u,this.Tableau=s,this.lastSolvedModel=null,this.External=p,this.Solve=function(t,e,n,s){if(s)for(var r in l)t=l[r](t);if(!t)throw new Error("Solver requires a model to operate on");if("object"==typeof t.optimize&&Object.keys(t.optimize>1))return i(681)(this,t);if(t.external){var o=Object.keys(p);if(o=JSON.stringify(o),!t.external.solver)throw new Error("The model you provided has an 'external' object that doesn't have a solver attribute. Use one of the following:"+o);if(!p[t.external.solver])throw new Error("No support (yet) for "+t.external.solver+". Please use one of these instead:"+o);return p[t.external.solver].solve(t)}t instanceof a==0&&(t=new a(e).loadJson(t));var h=t.solve();if(this.lastSolvedModel=t,h.solutionSet=h.generateSolutionSet(),n)return h;var c={};return c.feasible=h.feasible,c.result=h.evaluation,c.bounded=h.bounded,h._tableau.__isIntegral&&(c.isIntegral=!0),Object.keys(h.solutionSet).forEach((function(t){0!==h.solutionSet[t]&&(c[t]=h.solutionSet[t])})),c},this.ReformatLP=i(788),this.MultiObjective=function(t){return i(681)(this,t)}};void 0===(n=function(){return new g}.apply(e,[]))||(t.exports=n),t.exports=new g},66:()=>{},110:(t,e,i)=>{var n=i(442);n.prototype._putInBase=function(t){var e=this.rowByVarIndex[t];if(-1===e){for(var i=this.colByVarIndex[t],n=1;n<this.height;n+=1){var s=this.matrix[n][i];if(s<-this.precision||this.precision<s){e=n;break}}this.pivot(e,i)}return e},n.prototype._takeOutOfBase=function(t){var e=this.colByVarIndex[t];if(-1===e){for(var i=this.rowByVarIndex[t],n=this.matrix[i],s=1;s<this.height;s+=1){var a=n[s];if(a<-this.precision||this.precision<a){e=s;break}}this.pivot(i,e)}return e},n.prototype.updateVariableValues=function(){for(var t=this.variables.length,e=Math.round(1/this.precision),i=0;i<t;i+=1){var n=this.variables[i],s=n.index,a=this.rowByVarIndex[s];if(-1===a)n.value=0;else{var r=this.matrix[a][this.rhsColumn];n.value=Math.round((r+Number.EPSILON)*e)/e}}},n.prototype.updateRightHandSide=function(t,e){var i=this.height-1,n=this.rowByVarIndex[t.index];if(-1===n){for(var s=this.colByVarIndex[t.index],a=0;a<=i;a+=1){var r=this.matrix[a];r[this.rhsColumn]-=e*r[s]}var o=this.optionalObjectives.length;if(o>0)for(var l=0;l<o;l+=1){var h=this.optionalObjectives[l].reducedCosts;h[this.rhsColumn]-=e*h[s]}}else this.matrix[n][this.rhsColumn]-=e},n.prototype.updateConstraintCoefficient=function(t,e,i){if(t.index===e.index)throw new Error("[Tableau.updateConstraintCoefficient] constraint index should not be equal to variable index !");var n=this._putInBase(t.index),s=this.colByVarIndex[e.index];if(-1===s)for(var a=this.rowByVarIndex[e.index],r=0;r<this.width;r+=1)this.matrix[n][r]+=i*this.matrix[a][r];else this.matrix[n][s]-=i},n.prototype.updateCost=function(t,e){var i=t.index,n=this.width-1,s=this.colByVarIndex[i];if(-1===s){var a,r=this.matrix[this.rowByVarIndex[i]];if(0===t.priority){var o=this.matrix[0];for(a=0;a<=n;a+=1)o[a]+=e*r[a]}else{var l=this.objectivesByPriority[t.priority].reducedCosts;for(a=0;a<=n;a+=1)l[a]+=e*r[a]}}else this.matrix[0][s]-=e},n.prototype.addConstraint=function(t){var e=t.isUpperBound?1:-1,i=this.height,n=this.matrix[i];void 0===n&&(n=this.matrix[0].slice(),this.matrix[i]=n);for(var s=this.width-1,a=0;a<=s;a+=1)n[a]=0;n[this.rhsColumn]=e*t.rhs;for(var r=t.terms,o=r.length,l=0;l<o;l+=1){var h=r[l],c=h.coefficient,d=h.variable.index,u=this.rowByVarIndex[d];if(-1===u)n[this.colByVarIndex[d]]+=e*c;else{var p=this.matrix[u];for(p[this.rhsColumn],a=0;a<=s;a+=1)n[a]-=e*c*p[a]}}var g=t.index;this.varIndexByRow[i]=g,this.rowByVarIndex[g]=i,this.colByVarIndex[g]=-1,this.height+=1},n.prototype.removeConstraint=function(t){var e=t.index,i=this.height-1,n=this._putInBase(e),s=this.matrix[i];this.matrix[i]=this.matrix[n],this.matrix[n]=s,this.varIndexByRow[n]=this.varIndexByRow[i],this.varIndexByRow[i]=-1,this.rowByVarIndex[e]=-1,this.availableIndexes[this.availableIndexes.length]=e,t.slack.index=-1,this.height-=1},n.prototype.addVariable=function(t){var e=this.height-1,i=this.width,n=!0===this.model.isMinimization?-t.cost:t.cost,s=t.priority,a=this.optionalObjectives.length;if(a>0)for(var r=0;r<a;r+=1)this.optionalObjectives[r].reducedCosts[i]=0;0===s?this.matrix[0][i]=n:(this.setOptionalObjective(s,i,n),this.matrix[0][i]=0);for(var o=1;o<=e;o+=1)this.matrix[o][i]=0;var l=t.index;this.varIndexByCol[i]=l,this.rowByVarIndex[l]=-1,this.colByVarIndex[l]=i,this.width+=1},n.prototype.removeVariable=function(t){var e=t.index,i=this._takeOutOfBase(e),n=this.width-1;if(i!==n){for(var s=this.height-1,a=0;a<=s;a+=1){var r=this.matrix[a];r[i]=r[n]}var o=this.optionalObjectives.length;if(o>0)for(var l=0;l<o;l+=1){var h=this.optionalObjectives[l].reducedCosts;h[i]=h[n]}var c=this.varIndexByCol[n];this.varIndexByCol[i]=c,this.colByVarIndex[c]=i}this.varIndexByCol[n]=-1,this.colByVarIndex[e]=-1,this.availableIndexes[this.availableIndexes.length]=e,t.index=-1,this.width-=1}},184:(t,e,i)=>{var n=i(442);function s(t,e,i){this.type=t,this.varIndex=e,this.value=i}function a(t,e){this.relaxedEvaluation=t,this.cuts=e}function r(t,e){return e.relaxedEvaluation-t.relaxedEvaluation}n.prototype.applyCuts=function(t){if(this.restore(),this.addCutConstraints(t),this.simplex(),this.model.useMIRCuts)for(var e=!0;e;){var i=this.computeFractionalVolume(!0);this.applyMIRCuts(),this.simplex(),this.computeFractionalVolume(!0)>=.9*i&&(e=!1)}},n.prototype.branchAndCut=function(){var t=[],e=0,i=this.model.tolerance,n=!0,o=1e99;this.model.timeout&&(o=Date.now()+this.model.timeout);for(var l=1/0,h=null,c=[],d=0;d<this.optionalObjectives.length;d+=1)c.push(1/0);var u,p=new a(-1/0,[]);for(t.push(p);t.length>0&&!0===n&&Date.now()<o;)if(u=this.model.isMinimization?this.bestPossibleEval*(1+i):this.bestPossibleEval*(1-i),i>0&&l<u&&(n=!1),!((p=t.pop()).relaxedEvaluation>l)){var g=p.cuts;if(this.applyCuts(g),e++,!1!==this.feasible){var f=this.evaluation;if(!(f>l)){if(f===l){for(var m=!0,v=0;v<this.optionalObjectives.length&&!(this.optionalObjectives[v].reducedCosts[0]>c[v]);v+=1)if(this.optionalObjectives[v].reducedCosts[0]<c[v]){m=!1;break}if(m)continue}if(!0===this.isIntegral()){if(this.__isIntegral=!0,1===e)return void(this.branchAndCutIterations=e);h=p,l=f;for(var b=0;b<this.optionalObjectives.length;b+=1)c[b]=this.optionalObjectives[b].reducedCosts[0]}else{1===e&&this.save();for(var y=this.getMostFractionalVar(),x=y.index,w=[],I=[],B=g.length,L=0;L<B;L+=1){var C=g[L];C.varIndex===x?"min"===C.type?I.push(C):w.push(C):(w.push(C),I.push(C))}var E=Math.ceil(y.value),M=Math.floor(y.value),P=new s("min",x,E);w.push(P);var V=new s("max",x,M);I.push(V),t.push(new a(f,w)),t.push(new a(f,I)),t.sort(r)}}}}null!==h&&this.applyCuts(h.cuts),this.branchAndCutIterations=e}},217:(t,e,i)=>{i(442).prototype.log=function(t,e){console.log("****",t,"****"),console.log("Nb Variables",this.width-1),console.log("Nb Constraints",this.height-1),console.log("Basic Indexes",this.varIndexByRow),console.log("Non Basic Indexes",this.varIndexByCol),console.log("Rows",this.rowByVarIndex),console.log("Cols",this.colByVarIndex);var i,n,s,a,r,o,l,h,c,d,u,p="",g=[" "];for(n=1;n<this.width;n+=1)r=this.varIndexByCol[n],l=(o=void 0===(a=this.variablesPerIndex[r])?"c"+r:a.id).length,Math.abs(l-5),h=" ",c="\t",l>5?h+=" ":c+="\t",g[n]=h,p+=c+o;console.log(p);var f=this.matrix[this.costRowIndex],m="\t";for(i=1;i<this.width;i+=1)m+="\t",m+=g[i],m+=f[i].toFixed(5);for(m+="\t"+g[0]+f[0].toFixed(5),console.log(m+"\tZ"),s=1;s<this.height;s+=1){for(d=this.matrix[s],u="\t",n=1;n<this.width;n+=1)u+="\t"+g[n]+d[n].toFixed(5);u+="\t"+g[0]+d[0].toFixed(5),r=this.varIndexByRow[s],o=void 0===(a=this.variablesPerIndex[r])?"c"+r:a.id,console.log(u+"\t"+o)}console.log("");var v=this.optionalObjectives.length;if(v>0){console.log("    Optional objectives:");for(var b=0;b<v;b+=1){var y=this.optionalObjectives[b].reducedCosts,x="";for(i=1;i<this.width;i+=1)x+=y[i]<0?"":" ",x+=g[i],x+=y[i].toFixed(5);x+=(y[0]<0?"":" ")+g[0]+y[0].toFixed(5),console.log(x+" z"+b)}}return console.log("Feasible?",this.feasible),console.log("evaluation",this.evaluation),this}},227:(t,e,i)=>{function n(t){return(t=(t=t.replace("\\r\\n","\r\n")).split("\r\n")).filter((function(t){return!0!==new RegExp(" 0$","gi").test(t)&&!1!==new RegExp("\\d$","gi").test(t)})).map((function(t){return t.split(/\:{0,1} +(?=\d)/)})).reduce((function(t,e,i){return t[e[0]]=e[1],t}),{})}e.reformat=i(788),e.solve=function(t){return new Promise((function(e,s){"undefined"!=typeof window&&s("Function Not Available in Browser");var a=i(788)(t);t.external||s("Data for this function must be contained in the 'external' attribute. Not seeing anything there."),t.external.binPath||s("No Executable | Binary path provided in arguments as 'binPath'"),t.external.args||s("No arguments array for cli | bash provided on 'args' attribute"),t.external.tempName||s("No 'tempName' given. This is necessary to produce a staging file for the solver to operate on"),i(675).writeFile(t.external.tempName,a,(function(a,r){if(a)s(a);else{var o=i(66).execFile;t.external.args.push(t.external.tempName),o(t.external.binPath,t.external.args,(function(t,i){if(t)if(1===t.code)e(n(i));else{var a={code:t.code,meaning:{"-2":"Out of Memory",1:"SUBOPTIMAL",2:"INFEASIBLE",3:"UNBOUNDED",4:"DEGENERATE",5:"NUMFAILURE",6:"USER-ABORT",7:"TIMEOUT",9:"PRESOLVED",25:"ACCURACY ERROR",255:"FILE-ERROR"}[t.code],data:i};s(a)}else e(n(i))}))}}))}))}},269:(t,e,i)=>{var n=i(442);n.prototype.copy=function(){var t=new n(this.precision);t.width=this.width,t.height=this.height,t.nVars=this.nVars,t.model=this.model,t.variables=this.variables,t.variablesPerIndex=this.variablesPerIndex,t.unrestrictedVars=this.unrestrictedVars,t.lastElementIndex=this.lastElementIndex,t.varIndexByRow=this.varIndexByRow.slice(),t.varIndexByCol=this.varIndexByCol.slice(),t.rowByVarIndex=this.rowByVarIndex.slice(),t.colByVarIndex=this.colByVarIndex.slice(),t.availableIndexes=this.availableIndexes.slice();for(var e=[],i=0;i<this.optionalObjectives.length;i++)e[i]=this.optionalObjectives[i].copy();t.optionalObjectives=e;for(var s=this.matrix,a=new Array(this.height),r=0;r<this.height;r++)a[r]=s[r].slice();return t.matrix=a,t},n.prototype.save=function(){this.savedState=this.copy()},n.prototype.restore=function(){if(null!==this.savedState){var t,e,i=this.savedState,n=i.matrix;for(this.nVars=i.nVars,this.model=i.model,this.variables=i.variables,this.variablesPerIndex=i.variablesPerIndex,this.unrestrictedVars=i.unrestrictedVars,this.lastElementIndex=i.lastElementIndex,this.width=i.width,this.height=i.height,t=0;t<this.height;t+=1){var s=n[t],a=this.matrix[t];for(e=0;e<this.width;e+=1)a[e]=s[e]}var r=i.varIndexByRow;for(e=0;e<this.height;e+=1)this.varIndexByRow[e]=r[e];for(;this.varIndexByRow.length>this.height;)this.varIndexByRow.pop();var o=i.varIndexByCol;for(t=0;t<this.width;t+=1)this.varIndexByCol[t]=o[t];for(;this.varIndexByCol.length>this.width;)this.varIndexByCol.pop();for(var l=i.rowByVarIndex,h=i.colByVarIndex,c=0;c<this.nVars;c+=1)this.rowByVarIndex[c]=l[c],this.colByVarIndex[c]=h[c];if(i.optionalObjectives.length>0&&this.optionalObjectives.length>0){this.optionalObjectives=[],this.optionalObjectivePerPriority={};for(var d=0;d<i.optionalObjectives.length;d++){var u=i.optionalObjectives[d].copy();this.optionalObjectives[d]=u,this.optionalObjectivePerPriority[u.priority]=u}}}}},304:(t,e,i)=>{var n=i(442);n.prototype.countIntegerValues=function(){for(var t=0,e=1;e<this.height;e+=1)if(this.variablesPerIndex[this.varIndexByRow[e]].isInteger){var i=this.matrix[e][this.rhsColumn];(i-=Math.floor(i))<this.precision&&-i<this.precision&&(t+=1)}return t},n.prototype.isIntegral=function(){for(var t=this.model.integerVariables,e=t.length,i=0;i<e;i++){var n=this.rowByVarIndex[t[i].index];if(-1!==n){var s=this.matrix[n][this.rhsColumn];if(Math.abs(s-Math.round(s))>this.precision)return!1}}return!0},n.prototype.computeFractionalVolume=function(t){for(var e=-1,i=1;i<this.height;i+=1)if(this.variablesPerIndex[this.varIndexByRow[i]].isInteger){var n=this.matrix[i][this.rhsColumn];if(n=Math.abs(n),Math.min(n-Math.floor(n),Math.floor(n+1))<this.precision){if(!t)return 0}else-1===e?e=n:e*=n}return-1===e?0:e}},314:(t,e,i)=>{var n=i(442),s=i(773).SlackVariable;n.prototype.addCutConstraints=function(t){for(var e,i=t.length,n=this.height,a=n+i,r=n;r<a;r+=1)void 0===this.matrix[r]&&(this.matrix[r]=this.matrix[r-1].slice());this.height=a,this.nVars=this.width+this.height-2;for(var o=this.width-1,l=0;l<i;l+=1){var h=t[l],c=n+l,d="min"===h.type?-1:1,u=h.varIndex,p=this.rowByVarIndex[u],g=this.matrix[c];if(-1===p){for(g[this.rhsColumn]=d*h.value,e=1;e<=o;e+=1)g[e]=0;g[this.colByVarIndex[u]]=d}else{var f=this.matrix[p],m=f[this.rhsColumn];for(g[this.rhsColumn]=d*(h.value-m),e=1;e<=o;e+=1)g[e]=-d*f[e]}var v=this.getNewElementIndex();this.varIndexByRow[c]=v,this.rowByVarIndex[v]=c,this.colByVarIndex[v]=-1,this.variablesPerIndex[v]=new s("s"+v,v),this.nVars+=1}},n.prototype._addLowerBoundMIRCut=function(t){if(t===this.costRowIndex)return!1;this.model;var e=this.matrix;if(!this.variablesPerIndex[this.varIndexByRow[t]].isInteger)return!1;var i=e[t][this.rhsColumn],n=i-Math.floor(i);if(n<this.precision||1-this.precision<n)return!1;var a=this.height;e[a]=e[a-1].slice(),this.height+=1,this.nVars+=1;var r=this.getNewElementIndex();this.varIndexByRow[a]=r,this.rowByVarIndex[r]=a,this.colByVarIndex[r]=-1,this.variablesPerIndex[r]=new s("s"+r,r),e[a][this.rhsColumn]=Math.floor(i);for(var o=1;o<this.varIndexByCol.length;o+=1)if(this.variablesPerIndex[this.varIndexByCol[o]].isInteger){var l=e[t][o],h=Math.floor(l)+Math.max(0,l-Math.floor(l)-n)/(1-n);e[a][o]=h}else e[a][o]=Math.min(0,e[t][o]/(1-n));for(var c=0;c<this.width;c+=1)e[a][c]-=e[t][c];return!0},n.prototype._addUpperBoundMIRCut=function(t){if(t===this.costRowIndex)return!1;this.model;var e=this.matrix;if(!this.variablesPerIndex[this.varIndexByRow[t]].isInteger)return!1;var i=e[t][this.rhsColumn],n=i-Math.floor(i);if(n<this.precision||1-this.precision<n)return!1;var a=this.height;e[a]=e[a-1].slice(),this.height+=1,this.nVars+=1;var r=this.getNewElementIndex();this.varIndexByRow[a]=r,this.rowByVarIndex[r]=a,this.colByVarIndex[r]=-1,this.variablesPerIndex[r]=new s("s"+r,r),e[a][this.rhsColumn]=-n;for(var o=1;o<this.varIndexByCol.length;o+=1){var l=this.variablesPerIndex[this.varIndexByCol[o]],h=e[t][o],c=h-Math.floor(h);l.isInteger?e[a][o]=c<=n?-c:-(1-c)*n/c:e[a][o]=h>=0?-h:h*n/(1-n)}return!0},n.prototype.applyMIRCuts=function(){}},363:(t,e)=>{e.CleanObjectiveAttributes=function(t){var e,i,n;if("string"==typeof t.optimize){if(t.constraints[t.optimize]){for(i in e=Math.random(),t.variables)t.variables[i][t.optimize]&&(t.variables[i][e]=t.variables[i][t.optimize]);return t.constraints[e]=t.constraints[t.optimize],delete t.constraints[t.optimize],t}return t}for(n in t.optimize)if(t.constraints[n])if("equal"===t.constraints[n])delete t.optimize[n];else{for(i in e=Math.random(),t.variables)t.variables[i][n]&&(t.variables[i][e]=t.variables[i][n]);t.constraints[e]=t.constraints[n],delete t.constraints[n]}return t}},442:(t,e,i)=>{var n=i(824),s=i(746);function a(t){this.model=null,this.matrix=null,this.width=0,this.height=0,this.costRowIndex=0,this.rhsColumn=0,this.variablesPerIndex=[],this.unrestrictedVars=null,this.feasible=!0,this.evaluation=0,this.simplexIters=0,this.varIndexByRow=null,this.varIndexByCol=null,this.rowByVarIndex=null,this.colByVarIndex=null,this.precision=t||1e-8,this.optionalObjectives=[],this.objectivesByPriority={},this.savedState=null,this.availableIndexes=[],this.lastElementIndex=0,this.variables=null,this.nVars=0,this.bounded=!0,this.unboundedVarIndex=null,this.branchAndCutIterations=0}function r(t,e){this.priority=t,this.reducedCosts=new Array(e);for(var i=0;i<e;i+=1)this.reducedCosts[i]=0}t.exports=a,a.prototype.solve=function(){return this.model.getNumberOfIntegerVariables()>0?this.branchAndCut():this.simplex(),this.updateVariableValues(),this.getSolution()},r.prototype.copy=function(){var t=new r(this.priority,this.reducedCosts.length);return t.reducedCosts=this.reducedCosts.slice(),t},a.prototype.setOptionalObjective=function(t,e,i){var n=this.objectivesByPriority[t];void 0===n&&(n=new r(t,Math.max(this.width,e+1)),this.objectivesByPriority[t]=n,this.optionalObjectives.push(n),this.optionalObjectives.sort((function(t,e){return t.priority-e.priority}))),n.reducedCosts[e]=i},a.prototype.initialize=function(t,e,i,n){this.variables=i,this.unrestrictedVars=n,this.width=t,this.height=e;for(var s=new Array(t),a=0;a<t;a++)s[a]=0;this.matrix=new Array(e);for(var r=0;r<e;r++)this.matrix[r]=s.slice();this.varIndexByRow=new Array(this.height),this.varIndexByCol=new Array(this.width),this.varIndexByRow[0]=-1,this.varIndexByCol[0]=-1,this.nVars=t+e-2,this.rowByVarIndex=new Array(this.nVars),this.colByVarIndex=new Array(this.nVars),this.lastElementIndex=this.nVars},a.prototype._resetMatrix=function(){var t,e,i=this.model.variables,n=this.model.constraints,s=i.length,a=n.length,r=this.matrix[0],o=!0===this.model.isMinimization?-1:1;for(t=0;t<s;t+=1){var l=i[t],h=l.priority,c=o*l.cost;0===h?r[t+1]=c:this.setOptionalObjective(h,t+1,c),e=i[t].index,this.rowByVarIndex[e]=-1,this.colByVarIndex[e]=t+1,this.varIndexByCol[t+1]=e}for(var d=1,u=0;u<a;u+=1){var p,g,f=n[u],m=f.index;this.rowByVarIndex[m]=d,this.colByVarIndex[m]=-1,this.varIndexByRow[d]=m;var v=f.terms,b=v.length,y=this.matrix[d++];if(f.isUpperBound){for(p=0;p<b;p+=1)g=v[p],y[this.colByVarIndex[g.variable.index]]=g.coefficient;y[0]=f.rhs}else{for(p=0;p<b;p+=1)g=v[p],y[this.colByVarIndex[g.variable.index]]=-g.coefficient;y[0]=-f.rhs}}},a.prototype.setModel=function(t){this.model=t;var e=t.nVariables+1,i=t.nConstraints+1;return this.initialize(e,i,t.variables,t.unrestrictedVariables),this._resetMatrix(),this},a.prototype.getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var t=this.lastElementIndex;return this.lastElementIndex+=1,t},a.prototype.density=function(){for(var t=0,e=this.matrix,i=0;i<this.height;i++)for(var n=e[i],s=0;s<this.width;s++)0!==n[s]&&(t+=1);return t/(this.height*this.width)},a.prototype.setEvaluation=function(){var t=Math.round(1/this.precision),e=this.matrix[this.costRowIndex][this.rhsColumn],i=Math.round((Number.EPSILON+e)*t)/t;this.evaluation=i,0===this.simplexIters&&(this.bestPossibleEval=i)},a.prototype.getSolution=function(){var t=!0===this.model.isMinimization?this.evaluation:-this.evaluation;return this.model.getNumberOfIntegerVariables()>0?new s(this,t,this.feasible,this.bounded,this.branchAndCutIterations):new n(this,t,this.feasible,this.bounded)}},487:(t,e,i)=>{var n=i(442),s=(i(184),i(773)),a=s.Constraint,r=s.Equality,o=s.Variable,l=s.IntegerVariable;function h(t,e){this.tableau=new n(t),this.name=e,this.variables=[],this.integerVariables=[],this.unrestrictedVariables={},this.constraints=[],this.nConstraints=0,this.nVariables=0,this.isMinimization=!0,this.tableauInitialized=!1,this.relaxationIndex=1,this.useMIRCuts=!1,this.checkForCycles=!0,this.messages=[]}s.Term,t.exports=h,h.prototype.minimize=function(){return this.isMinimization=!0,this},h.prototype.maximize=function(){return this.isMinimization=!1,this},h.prototype._getNewElementIndex=function(){if(this.availableIndexes.length>0)return this.availableIndexes.pop();var t=this.lastElementIndex;return this.lastElementIndex+=1,t},h.prototype._addConstraint=function(t){var e=t.slack;this.tableau.variablesPerIndex[e.index]=e,this.constraints.push(t),this.nConstraints+=1,!0===this.tableauInitialized&&this.tableau.addConstraint(t)},h.prototype.smallerThan=function(t){var e=new a(t,!0,this.tableau.getNewElementIndex(),this);return this._addConstraint(e),e},h.prototype.greaterThan=function(t){var e=new a(t,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(e),e},h.prototype.equal=function(t){var e=new a(t,!0,this.tableau.getNewElementIndex(),this);this._addConstraint(e);var i=new a(t,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(i),new r(e,i)},h.prototype.addVariable=function(t,e,i,n,s){if("string"==typeof s)switch(s){case"required":default:s=0;break;case"strong":s=1;break;case"medium":s=2;break;case"weak":s=3}var a,r=this.tableau.getNewElementIndex();return null==e&&(e="v"+r),null==t&&(t=0),null==s&&(s=0),i?(a=new l(e,t,r,s),this.integerVariables.push(a)):a=new o(e,t,r,s),this.variables.push(a),this.tableau.variablesPerIndex[r]=a,n&&(this.unrestrictedVariables[r]=!0),this.nVariables+=1,!0===this.tableauInitialized&&this.tableau.addVariable(a),a},h.prototype._removeConstraint=function(t){var e=this.constraints.indexOf(t);-1!==e?(this.constraints.splice(e,1),this.nConstraints-=1,!0===this.tableauInitialized&&this.tableau.removeConstraint(t),t.relaxation&&this.removeVariable(t.relaxation)):console.warn("[Model.removeConstraint] Constraint not present in model")},h.prototype.removeConstraint=function(t){return t.isEquality?(this._removeConstraint(t.upperBound),this._removeConstraint(t.lowerBound)):this._removeConstraint(t),this},h.prototype.removeVariable=function(t){var e=this.variables.indexOf(t);if(-1!==e)return this.variables.splice(e,1),!0===this.tableauInitialized&&this.tableau.removeVariable(t),this;console.warn("[Model.removeVariable] Variable not present in model")},h.prototype.updateRightHandSide=function(t,e){return!0===this.tableauInitialized&&this.tableau.updateRightHandSide(t,e),this},h.prototype.updateConstraintCoefficient=function(t,e,i){return!0===this.tableauInitialized&&this.tableau.updateConstraintCoefficient(t,e,i),this},h.prototype.setCost=function(t,e){var i=t-e.cost;return!1===this.isMinimization&&(i=-i),e.cost=t,this.tableau.updateCost(e,i),this},h.prototype.loadJson=function(t){this.isMinimization="max"!==t.opType;for(var e=t.variables,i=t.constraints,n={},s={},a=Object.keys(i),o=a.length,l=0;l<o;l+=1){var h,c,d=a[l],u=i[d],p=u.equal,g=u.weight,f=u.priority,m=void 0!==g||void 0!==f;if(void 0===p){var v=u.min;void 0!==v&&(h=this.greaterThan(v),n[d]=h,m&&h.relax(g,f));var b=u.max;void 0!==b&&(c=this.smallerThan(b),s[d]=c,m&&c.relax(g,f))}else{h=this.greaterThan(p),n[d]=h,c=this.smallerThan(p),s[d]=c;var y=new r(h,c);m&&y.relax(g,f)}}var x=Object.keys(e),w=x.length;this.tolerance=t.tolerance||0,t.timeout&&(this.timeout=t.timeout),t.options&&(t.options.timeout&&(this.timeout=t.options.timeout),0===this.tolerance&&(this.tolerance=t.options.tolerance||0),t.options.useMIRCuts&&(this.useMIRCuts=t.options.useMIRCuts),void 0===t.options.exitOnCycles?this.checkForCycles=!0:this.checkForCycles=t.options.exitOnCycles);for(var I=t.ints||{},B=t.binaries||{},L=t.unrestricted||{},C=t.optimize,E=0;E<w;E+=1){var M=x[E],P=e[M],V=P[C]||0,$=!!B[M],S=!!I[M]||$,k=!!L[M],R=this.addVariable(V,M,S,k);$&&this.smallerThan(1).addTerm(1,R);var O=Object.keys(P);for(l=0;l<O.length;l+=1){var D=O[l];if(D!==C){var q=P[D],A=n[D];void 0!==A&&A.addTerm(q,R);var _=s[D];void 0!==_&&_.addTerm(q,R)}}}return this},h.prototype.getNumberOfIntegerVariables=function(){return this.integerVariables.length},h.prototype.solve=function(){return!1===this.tableauInitialized&&(this.tableau.setModel(this),this.tableauInitialized=!0),this.tableau.solve()},h.prototype.isFeasible=function(){return this.tableau.feasible},h.prototype.save=function(){return this.tableau.save()},h.prototype.restore=function(){return this.tableau.restore()},h.prototype.activateMIRCuts=function(t){this.useMIRCuts=t},h.prototype.debug=function(t){this.checkForCycles=t},h.prototype.log=function(t){return this.tableau.log(t)}},675:()=>{},681:t=>{t.exports=function(t,e){var i,n,s,a,r,o=e.optimize,l=JSON.parse(JSON.stringify(e.optimize)),h=Object.keys(e.optimize),c=0,d={},u="",p={},g=[];for(delete e.optimize,n=0;n<h.length;n++)l[h[n]]=0;for(n=0;n<h.length;n++){for(r in e.optimize=h[n],e.opType=o[h[n]],i=t.Solve(e,void 0,void 0,!0),h)if(!e.variables[h[r]])for(a in i[h[r]]=i[h[r]]?i[h[r]]:0,e.variables)e.variables[a][h[r]]&&i[a]&&(i[h[r]]+=i[a]*e.variables[a][h[r]]);for(u="base",s=0;s<h.length;s++)i[h[s]]?u+="-"+(1e3*i[h[s]]|0)/1e3:u+="-0";if(!d[u]){for(d[u]=1,c++,s=0;s<h.length;s++)i[h[s]]&&(l[h[s]]+=i[h[s]]);delete i.feasible,delete i.result,g.push(i)}}for(n=0;n<h.length;n++)e.constraints[h[n]]={equal:l[h[n]]/c};for(n in e.optimize="cheater-"+Math.random(),e.opType="max",e.variables)e.variables[n].cheater=1;for(n in g)for(a in g[n])p[a]=p[a]||{min:1e99,max:-1e99};for(n in p)for(a in g)g[a][n]?(g[a][n]>p[n].max&&(p[n].max=g[a][n]),g[a][n]<p[n].min&&(p[n].min=g[a][n])):(g[a][n]=0,p[n].min=0);return{midpoint:i=t.Solve(e,void 0,void 0,!0),vertices:g,ranges:p}}},746:(t,e,i)=>{var n=i(824);function s(t,e,i,s,a){n.call(this,t,e,i,s),this.iter=a}t.exports=s,s.prototype=Object.create(n.prototype),s.constructor=s},773:t=>{function e(t,e,i,n){this.id=t,this.cost=e,this.index=i,this.value=0,this.priority=n}function i(t,i,n,s){e.call(this,t,i,n,s)}function n(t,i){e.call(this,t,0,i,0)}function s(t,e){this.variable=t,this.coefficient=e}function a(t,e,i){return 0===i||"required"===i?null:(e=e||1,i=i||1,!1===t.isMinimization&&(e=-e),t.addVariable(e,"r"+t.relaxationIndex++,!1,!1,i))}function r(t,e,i,s){this.slack=new n("s"+i,i),this.index=i,this.model=s,this.rhs=t,this.isUpperBound=e,this.terms=[],this.termsByVarIndex={},this.relaxation=null}function o(t,e){this.upperBound=t,this.lowerBound=e,this.model=t.model,this.rhs=t.rhs,this.relaxation=null}i.prototype.isInteger=!0,n.prototype.isSlack=!0,r.prototype.addTerm=function(t,e){var i=e.index,n=this.termsByVarIndex[i];if(void 0===n)n=new s(e,t),this.termsByVarIndex[i]=n,this.terms.push(n),!0===this.isUpperBound&&(t=-t),this.model.updateConstraintCoefficient(this,e,t);else{var a=n.coefficient+t;this.setVariableCoefficient(a,e)}return this},r.prototype.removeTerm=function(t){return this},r.prototype.setRightHandSide=function(t){if(t!==this.rhs){var e=t-this.rhs;!0===this.isUpperBound&&(e=-e),this.rhs=t,this.model.updateRightHandSide(this,e)}return this},r.prototype.setVariableCoefficient=function(t,e){var i=e.index;if(-1!==i){var n=this.termsByVarIndex[i];if(void 0===n)this.addTerm(t,e);else if(t!==n.coefficient){var s=t-n.coefficient;!0===this.isUpperBound&&(s=-s),n.coefficient=t,this.model.updateConstraintCoefficient(this,e,s)}return this}console.warn("[Constraint.setVariableCoefficient] Trying to change coefficient of inexistant variable.")},r.prototype.relax=function(t,e){this.relaxation=a(this.model,t,e),this._relax(this.relaxation)},r.prototype._relax=function(t){null!==t&&(this.isUpperBound?this.setVariableCoefficient(-1,t):this.setVariableCoefficient(1,t))},o.prototype.isEquality=!0,o.prototype.addTerm=function(t,e){return this.upperBound.addTerm(t,e),this.lowerBound.addTerm(t,e),this},o.prototype.removeTerm=function(t){return this.upperBound.removeTerm(t),this.lowerBound.removeTerm(t),this},o.prototype.setRightHandSide=function(t){this.upperBound.setRightHandSide(t),this.lowerBound.setRightHandSide(t),this.rhs=t},o.prototype.relax=function(t,e){this.relaxation=a(this.model,t,e),this.upperBound.relaxation=this.relaxation,this.upperBound._relax(this.relaxation),this.lowerBound.relaxation=this.relaxation,this.lowerBound._relax(this.relaxation)},t.exports={Constraint:r,Variable:e,IntegerVariable:i,SlackVariable:n,Equality:o,Term:s}},788:t=>{t.exports=function(t){return t.length?function(t){var e={is_blank:/^\W{0,}$/,is_objective:/(max|min)(imize){0,}\:/i,is_int:/^(?!\/\*)\W{0,}int/i,is_bin:/^(?!\/\*)\W{0,}bin/i,is_constraint:/(\>|\<){0,}\=/i,is_unrestricted:/^\S{0,}unrestricted/i,parse_lhs:/(\-|\+){0,1}\s{0,1}\d{0,}\.{0,}\d{0,}\s{0,}[A-Za-z]\S{0,}/gi,parse_rhs:/(\-|\+){0,1}\d{1,}\.{0,}\d{0,}\W{0,}\;{0,1}$/i,parse_dir:/(\>|\<){0,}\=/gi,parse_int:/[^\s|^\,]+/gi,parse_bin:/[^\s|^\,]+/gi,get_num:/(\-|\+){0,1}(\W|^)\d+\.{0,1}\d{0,}/g,get_word:/[A-Za-z].*/},i={opType:"",optimize:"_obj",constraints:{},variables:{}},n={">=":"min","<=":"max","=":"equal"},s="",a=null,r="",o="",l="",h=0;"string"==typeof t&&(t=t.split("\n"));for(var c=0;c<t.length;c++)if(l="__"+c,s=t[c],a=null,e.is_objective.test(s))i.opType=s.match(/(max|min)/gi)[0],(a=s.match(e.parse_lhs).map((function(t){return t.replace(/\s+/,"")})).slice(1)).forEach((function(t){r=null===(r=t.match(e.get_num))?"-"===t.substr(0,1)?-1:1:r[0],r=parseFloat(r),o=t.match(e.get_word)[0].replace(/\;$/,""),i.variables[o]=i.variables[o]||{},i.variables[o]._obj=r}));else if(e.is_int.test(s))a=s.match(e.parse_int).slice(1),i.ints=i.ints||{},a.forEach((function(t){t=t.replace(";",""),i.ints[t]=1}));else if(e.is_bin.test(s))a=s.match(e.parse_bin).slice(1),i.binaries=i.binaries||{},a.forEach((function(t){t=t.replace(";",""),i.binaries[t]=1}));else if(e.is_constraint.test(s)){var d=s.indexOf(":");(a=(-1===d?s:s.slice(d+1)).match(e.parse_lhs).map((function(t){return t.replace(/\s+/,"")}))).forEach((function(t){r=null===(r=t.match(e.get_num))?"-"===t.substr(0,1)?-1:1:r[0],r=parseFloat(r),o=t.match(e.get_word)[0],i.variables[o]=i.variables[o]||{},i.variables[o][l]=r})),h=parseFloat(s.match(e.parse_rhs)[0]),s=n[s.match(e.parse_dir)[0]],i.constraints[l]=i.constraints[l]||{},i.constraints[l][s]=h}else e.is_unrestricted.test(s)&&(a=s.match(e.parse_int).slice(1),i.unrestricted=i.unrestricted||{},a.forEach((function(t){t=t.replace(";",""),i.unrestricted[t]=1})));return i}(t):function(t){if(!t)throw new Error("Solver requires a model to operate on");var e="",i={max:"<=",min:">=",equal:"="},n=new RegExp("[^A-Za-z0-9_[{}/.&#$%~'@^]","gi");if(t.opType)for(var s in e+=t.opType+":",t.variables)t.variables[s][s]=t.variables[s][s]?t.variables[s][s]:1,t.variables[s][t.optimize]&&(e+=" "+t.variables[s][t.optimize]+" "+s.replace(n,"_"));else e+="max:";for(var a in e+=";\n\n",t.constraints)for(var r in t.constraints[a])if(void 0!==i[r]){for(var o in t.variables)void 0!==t.variables[o][a]&&(e+=" "+t.variables[o][a]+" "+o.replace(n,"_"));e+=" "+i[r]+" "+t.constraints[a][r],e+=";\n"}if(t.ints)for(var l in e+="\n\n",t.ints)e+="int "+l.replace(n,"_")+";\n";if(t.unrestricted)for(var h in e+="\n\n",t.unrestricted)e+="unrestricted "+h.replace(n,"_")+";\n";return e}(t)}},791:(t,e,i)=>{t.exports={lpsolve:i(227)}},824:t=>{function e(t,e,i,n){this.feasible=i,this.evaluation=e,this.bounded=n,this._tableau=t}t.exports=e,e.prototype.generateSolutionSet=function(){for(var t={},e=this._tableau,i=e.varIndexByRow,n=e.variablesPerIndex,s=e.matrix,a=e.rhsColumn,r=e.height-1,o=Math.round(1/e.precision),l=1;l<=r;l+=1){var h=n[i[l]];if(void 0!==h&&!0!==h.isSlack){var c=s[l][a];t[h.id]=Math.round((Number.EPSILON+c)*o)/o}}return t}},871:(t,e,i)=>{i(981),i(314),i(110),i(217),i(269),i(38),i(304),t.exports=i(442)},981:(t,e,i)=>{var n=i(442);n.prototype.simplex=function(){return this.bounded=!0,this.phase1(),!0===this.feasible&&this.phase2(),this},n.prototype.phase1=function(){for(var t=this.model.checkForCycles,e=[],i=this.matrix,n=this.rhsColumn,s=this.width-1,a=this.height-1,r=0;;){for(var o=0,l=-this.precision,h=1;h<=a;h++){this.unrestrictedVars[this.varIndexByRow[h]];var c=i[h][n];c<l&&(l=c,o=h)}if(0===o)return this.feasible=!0,r;for(var d=0,u=-1/0,p=i[0],g=i[o],f=1;f<=s;f++){var m=g[f];if(!0===this.unrestrictedVars[this.varIndexByCol[f]]||m<-this.precision){var v=-p[f]/m;u<v&&(u=v,d=f)}}if(0===d)return this.feasible=!1,r;if(t){e.push([this.varIndexByRow[o],this.varIndexByCol[d]]);var b=this.checkForCycles(e);if(b.length>0)return this.model.messages.push("Cycle in phase 1"),this.model.messages.push("Start :"+b[0]),this.model.messages.push("Length :"+b[1]),this.feasible=!1,r}this.pivot(o,d),r+=1}},n.prototype.phase2=function(){for(var t,e,i=this.model.checkForCycles,n=[],s=this.matrix,a=this.rhsColumn,r=this.width-1,o=this.height-1,l=this.precision,h=this.optionalObjectives.length,c=null,d=0;;){var u=s[this.costRowIndex];h>0&&(c=[]);for(var p=0,g=l,f=!1,m=1;m<=r;m++)t=u[m],e=!0===this.unrestrictedVars[this.varIndexByCol[m]],h>0&&-l<t&&t<l?c.push(m):e&&t<0?-t>g&&(g=-t,p=m,f=!0):t>g&&(g=t,p=m,f=!1);if(h>0)for(var v=0;0===p&&c.length>0&&v<h;){var b=[],y=this.optionalObjectives[v].reducedCosts;g=l;for(var x=0;x<c.length;x++)t=y[m=c[x]],e=!0===this.unrestrictedVars[this.varIndexByCol[m]],-l<t&&t<l?b.push(m):e&&t<0?-t>g&&(g=-t,p=m,f=!0):t>g&&(g=t,p=m,f=!1);c=b,v+=1}if(0===p)return this.setEvaluation(),this.simplexIters+=1,d;for(var w=0,I=1/0,B=(this.varIndexByRow,1);B<=o;B++){var L=s[B],C=L[a],E=L[p];if(!(-l<E&&E<l)){if(E>0&&l>C&&C>-l){I=0,w=B;break}var M=f?-C/E:C/E;M>l&&I>M&&(I=M,w=B)}}if(I===1/0)return this.evaluation=-1/0,this.bounded=!1,this.unboundedVarIndex=this.varIndexByCol[p],d;if(i){n.push([this.varIndexByRow[w],this.varIndexByCol[p]]);var P=this.checkForCycles(n);if(P.length>0)return this.model.messages.push("Cycle in phase 2"),this.model.messages.push("Start :"+P[0]),this.model.messages.push("Length :"+P[1]),this.feasible=!1,d}this.pivot(w,p,!0),d+=1}};var s=[];n.prototype.pivot=function(t,e){var i=this.matrix,n=i[t][e],a=this.height-1,r=this.width-1,o=this.varIndexByRow[t],l=this.varIndexByCol[e];this.varIndexByRow[t]=l,this.varIndexByCol[e]=o,this.rowByVarIndex[l]=t,this.rowByVarIndex[o]=-1,this.colByVarIndex[l]=-1,this.colByVarIndex[o]=e;for(var h,c,d,u=i[t],p=0,g=0;g<=r;g++)u[g]>=-1e-16&&u[g]<=1e-16?u[g]=0:(u[g]/=n,s[p]=g,p+=1);u[e]=1/n,this.precision;for(var f=0;f<=a;f++)if(f!==t&&!(i[f][e]>=-1e-16&&i[f][e]<=1e-16)){var m=i[f];if((h=m[e])>=-1e-16&&h<=1e-16)0!==h&&(m[e]=0);else{for(c=0;c<p;c++)(d=u[g=s[c]])>=-1e-16&&d<=1e-16?0!==d&&(u[g]=0):m[g]=m[g]-h*d;m[e]=-h/n}}var v=this.optionalObjectives.length;if(v>0)for(var b=0;b<v;b+=1){var y=this.optionalObjectives[b].reducedCosts;if(0!==(h=y[e])){for(c=0;c<p;c++)0!==(d=u[g=s[c]])&&(y[g]=y[g]-h*d);y[e]=-h/n}}},n.prototype.checkForCycles=function(t){for(var e=0;e<t.length-1;e++)for(var i=e+1;i<t.length;i++){var n=t[e],s=t[i];if(n[0]===s[0]&&n[1]===s[1]){if(i-e>t.length-i)break;for(var a=!0,r=1;r<i-e;r++){var o=t[e+r],l=t[i+r];if(o[0]!==l[0]||o[1]!==l[1]){a=!1;break}}if(a)return[e,i-e]}}return[]}}},e={};function i(n){var s=e[n];if(void 0!==s)return s.exports;var a=e[n]={exports:{}};return t[n](a,a.exports,i),a.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var n={};(()=>{"use strict";i.d(n,{R:()=>w});const t={data:{pieces:{},motherBars:{}},initData:function(){return this.data={pieces:{},motherBars:{}},this.data},getData:function(){return this.data},parsePiecesCSV:function(t,e){const i=e||this.initData(),n=t.split("\n");for(let t=1;t<n.length;t++){const e=n[t].trim();if(!e)continue;const s=e.split(",");if(s.length<4)continue;const a=s[0].trim().toLowerCase(),r=s[1].trim(),o=parseInt(s[2].trim(),10),l=parseInt(s[3].trim(),10);isNaN(o)||isNaN(l)||o<=0||l<=0||("mere"===a||"mother"===a?this.addMotherBar(r,o,l,i):"fille"!==a&&"daughter"!==a&&"piece"!==a||this.addPiece(r,o,l,i))}return e||(this.data=i),i},addPiece:function(t,e,i,n){if(!t)throw new Error("Le mod√®le est requis pour ajouter une pi√®ce.");if(!e||e<=0)throw new Error("La longueur doit √™tre un nombre positif.");const s=n||this.data;s.pieces[t]||(s.pieces[t]=[]);const a=s.pieces[t].find((t=>t.length===e));return a?a.quantity=i:s.pieces[t].push({length:e,quantity:i}),!0},addMotherBar:function(t,e,i,n){if(!t)throw new Error("Le mod√®le est requis pour ajouter une barre m√®re.");if(!e||e<=0)throw new Error("La longueur doit √™tre un nombre positif.");const s=n||this.data;s.motherBars[t]||(s.motherBars[t]=[]);const a=s.motherBars[t].find((t=>t.length===e));return a?a.quantity=i:s.motherBars[t].push({length:e,quantity:i}),!0},deletePiece:function(t,e,i){const n=i||this.data;if(n.pieces[t]){const i=n.pieces[t].findIndex((t=>t.length===e));if(-1!==i)return n.pieces[t].splice(i,1),0===n.pieces[t].length&&delete n.pieces[t],!0}return!1},deleteMotherBar:function(t,e,i){const n=i||this.data;if(n.motherBars[t]){const i=n.motherBars[t].findIndex((t=>t.length===e));if(-1!==i)return n.motherBars[t].splice(i,1),0===n.motherBars[t].length&&delete n.motherBars[t],!0}return!1},validateData:function(){if(0===Object.keys(this.data.pieces).length)throw new Error("Veuillez d'abord importer ou ajouter des pi√®ces √† d√©couper.");if(0===Object.keys(this.data.motherBars).length)throw new Error("Veuillez d√©finir des barres m√®res avant de continuer.");let t=!1;for(const e in this.data.pieces)if(this.data.pieces[e]&&this.data.pieces[e].length>0){t=!0;break}if(!t)throw new Error("Veuillez d'abord ajouter des pi√®ces √† d√©couper.")}},e={dataManager:null,algorithmService:null,resultsRenderer:null,data:null,init:function(t){this.dataManager=t.dataManager,this.algorithmService=t.algorithmService,this.resultsRenderer=t.resultsRenderer,this.data=t.data,this.setupNavigation(),this.setupImportModal(),this.setupTableActions(),this.setupAlgorithmButtons(),this.renderTables()},setupNavigation:function(){document.querySelectorAll(".nav-btn").forEach((t=>{t.addEventListener("click",(()=>{document.querySelectorAll(".nav-btn").forEach((t=>t.classList.remove("active"))),t.classList.add("active"),document.querySelectorAll(".content-section").forEach((t=>{t.classList.remove("active")}));const e=t.getAttribute("data-section");document.getElementById(e).classList.add("active")}))}))},setupImportModal:function(){document.getElementById("import-btn").addEventListener("click",(()=>{document.getElementById("import-modal").classList.remove("hidden")})),document.querySelectorAll(".close-modal").forEach((t=>{t.addEventListener("click",(()=>{document.getElementById("import-modal").classList.add("hidden")}))})),document.getElementById("csv-file-input").addEventListener("change",(t=>{const e=t.target.files[0]?.name||"";e&&(t.target.nextElementSibling.querySelector(".file-prompt").textContent=e)})),document.getElementById("confirm-import").addEventListener("click",(()=>{const t=document.getElementById("csv-file-input").files[0];if(t){const e=new FileReader;e.onload=t=>{try{this.dataManager.parsePiecesCSV(t.target.result),this.renderTables(),document.getElementById("import-modal").classList.add("hidden")}catch(t){alert(`Erreur lors de l'importation: ${t.message}`)}},e.readAsText(t)}else alert("Veuillez d'abord s√©lectionner un fichier.")}))},setupTableActions:function(){this.setupStockBarsTableActions(),this.setupPiecesTableActions()},setupStockBarsTableActions:function(){const t=document.getElementById("stock-bars-table");t.addEventListener("click",(t=>{if(t.target.classList.contains("delete-btn")){const e=t.target.closest("tr"),i=e.getAttribute("data-model"),n=parseInt(e.getAttribute("data-length"),10);confirm(`√ätes-vous s√ªr de vouloir supprimer cette barre m√®re ${i} de longueur ${n}?`)&&(this.dataManager.deleteMotherBar(i,n),this.renderTables())}t.target.classList.contains("editable-cell")&&this.activateEditCell(t.target,"stock")}));const e=document.createElement("tr");e.classList.add("add-row"),e.innerHTML='\n      <td><input type="text" placeholder="Mod√®le" id="add-stock-model"></td>\n      <td><input type="number" placeholder="Longueur" id="add-stock-length"></td>\n      <td><input type="number" placeholder="Quantit√©" id="add-stock-quantity"></td>\n      <td class="delete-cell">\n        <button id="add-stock-bar-btn" class="btn btn-sm btn-success">+</button>\n      </td>\n    ',t.appendChild(e),document.getElementById("add-stock-bar-btn").addEventListener("click",(()=>{this.addMotherBarFromInputs()})),document.getElementById("add-stock-model").addEventListener("keypress",(t=>{"Enter"===t.key&&this.addMotherBarFromInputs()})),document.getElementById("add-stock-length").addEventListener("keypress",(t=>{"Enter"===t.key&&this.addMotherBarFromInputs()})),document.getElementById("add-stock-quantity").addEventListener("keypress",(t=>{"Enter"===t.key&&this.addMotherBarFromInputs()}))},addMotherBarFromInputs:function(){const t=document.getElementById("add-stock-model"),e=document.getElementById("add-stock-length"),i=document.getElementById("add-stock-quantity"),n=t.value.trim(),s=parseInt(e.value,10),a=parseInt(i.value,10);try{this.dataManager.addMotherBar(n,s,a)&&(t.value="",e.value="",i.value="",this.renderTables())}catch(t){alert(t.message)}},setupPiecesTableActions:function(){const t=document.getElementById("pieces-table");t.addEventListener("click",(t=>{if(t.target.classList.contains("delete-btn")){const e=t.target.closest("tr"),i=e.getAttribute("data-model"),n=parseInt(e.getAttribute("data-length"),10);confirm(`√ätes-vous s√ªr de vouloir supprimer cette pi√®ce ${i} de longueur ${n}?`)&&(this.dataManager.deletePiece(i,n),this.renderTables())}t.target.classList.contains("editable-cell")&&this.activateEditCell(t.target,"pieces")}));const e=document.createElement("tr");e.classList.add("add-row"),e.innerHTML='\n      <td><input type="text" placeholder="Mod√®le" id="add-piece-model"></td>\n      <td><input type="number" placeholder="Longueur" id="add-piece-length"></td>\n      <td><input type="number" placeholder="Quantit√©" id="add-piece-quantity"></td>\n      <td class="delete-cell">\n        <button id="add-piece-btn" class="btn btn-sm btn-success">+</button>\n      </td>\n    ',t.appendChild(e),document.getElementById("add-piece-btn").addEventListener("click",(()=>{this.addPieceFromInputs()})),document.getElementById("add-piece-model").addEventListener("keypress",(t=>{"Enter"===t.key&&this.addPieceFromInputs()})),document.getElementById("add-piece-length").addEventListener("keypress",(t=>{"Enter"===t.key&&this.addPieceFromInputs()})),document.getElementById("add-piece-quantity").addEventListener("keypress",(t=>{"Enter"===t.key&&this.addPieceFromInputs()}))},addPieceFromInputs:function(){const t=document.getElementById("add-piece-model"),e=document.getElementById("add-piece-length"),i=document.getElementById("add-piece-quantity"),n=t.value.trim(),s=parseInt(e.value,10),a=parseInt(i.value,10);try{this.dataManager.addPiece(n,s,a)&&(t.value="",e.value="",i.value="",this.renderTables())}catch(t){alert(t.message)}},activateEditCell:function(t,e){const i=t.parentElement,n=t.textContent,s=t.getAttribute("data-field"),a=i.getAttribute("data-model"),r=parseInt(i.getAttribute("data-length"),10);if(t.classList.contains("editing"))return;t.classList.add("editing"),t.setAttribute("data-original",n);const o=document.createElement("input");o.type="model"===s?"text":"number",o.value=n,t.textContent="",t.appendChild(o),o.focus(),o.addEventListener("blur",(()=>{this.saveEditCell(t,e,a,r,s)})),o.addEventListener("keypress",(e=>{"Enter"===e.key?o.blur():"Escape"===e.key&&(t.textContent=t.getAttribute("data-original"),t.classList.remove("editing"))}))},saveEditCell:function(t,e,i,n,s){if(!t.classList.contains("editing"))return;const a=t.querySelector("input"),r="number"===a.type?parseInt(a.value,10):a.value.trim();try{"stock"===e?this.updateStockBarValue(i,n,s,r):this.updatePieceValue(i,n,s,r),t.textContent=r,t.classList.remove("editing"),this.renderTables()}catch(e){alert(e.message),t.textContent=t.getAttribute("data-original"),t.classList.remove("editing")}},updateStockBarValue:function(t,e,i,n){const s=this.dataManager.getData();if(("length"===i||"quantity"===i)&&(isNaN(n)||n<=0))throw new Error("La valeur doit √™tre un nombre positif.");if("model"===i&&!n)throw new Error("Le mod√®le ne peut pas √™tre vide.");if(!s.motherBars[t]||!s.motherBars[t].some((t=>t.length===e)))throw new Error(`Barre m√®re ${t} de longueur ${e} non trouv√©e.`);if("model"===i){const i=s.motherBars[t].find((t=>t.length===e));this.dataManager.addMotherBar(n,i.length,i.quantity),this.dataManager.deleteMotherBar(t,e)}else if("length"===i){const i=s.motherBars[t].find((t=>t.length===e));this.dataManager.addMotherBar(t,n,i.quantity),this.dataManager.deleteMotherBar(t,e)}else if("quantity"===i){const i=s.motherBars[t].findIndex((t=>t.length===e));-1!==i&&(s.motherBars[t][i].quantity=n)}},updatePieceValue:function(t,e,i,n){const s=this.dataManager.getData();if(("length"===i||"quantity"===i)&&(isNaN(n)||n<=0))throw new Error("La valeur doit √™tre un nombre positif.");if("model"===i&&!n)throw new Error("Le mod√®le ne peut pas √™tre vide.");if(!s.pieces[t]||!s.pieces[t].some((t=>t.length===e)))throw new Error(`Pi√®ce ${t} de longueur ${e} non trouv√©e.`);if("model"===i){const i=s.pieces[t].find((t=>t.length===e));this.dataManager.addPiece(n,i.length,i.quantity),this.dataManager.deletePiece(t,e)}else if("length"===i){const i=s.pieces[t].find((t=>t.length===e));this.dataManager.addPiece(t,n,i.quantity),this.dataManager.deletePiece(t,e)}else if("quantity"===i){const i=s.pieces[t].findIndex((t=>t.length===e));-1!==i&&(s.pieces[t][i].quantity=n)}},setupAlgorithmButtons:function(){document.getElementById("run-ffd-btn").addEventListener("click",(()=>{this.executeAlgorithm("ffd")})),document.getElementById("run-ilp-btn").addEventListener("click",(()=>{this.executeAlgorithm("ilp")})),document.getElementById("run-compare-btn").addEventListener("click",(()=>{this.executeAlgorithm("compare")}))},executeAlgorithm:function(t){try{this.dataManager.validateData(),document.getElementById("loading-overlay").classList.remove("hidden"),"compare"!==t&&document.querySelectorAll(".nav-btn")[1].click();const e="greedy"===t||"ffd"===t?"First-Fit Decreasing":"ilp"===t?"Programmation Lin√©aire (ILP)":"Comparaison";document.getElementById("result-algorithm").textContent=e,setTimeout((()=>{try{const e=this.algorithmService.runAlgorithm(t,this.dataManager.getData());if("compare"===t){document.querySelectorAll(".nav-btn")[1].click();const t="ffd"===e.bestAlgorithm?"First-Fit Decreasing (meilleur)":"Programmation Lin√©aire (meilleur)";document.getElementById("result-algorithm").textContent=t}this.resultsRenderer.renderResults(e,this.algorithmService)}catch(t){console.error("Algorithm execution error:",t);const e=document.getElementById("results-container");this.resultsRenderer.renderErrorMessage(e,"Erreur lors de l'ex√©cution",t.message||"Une erreur s'est produite")}finally{document.getElementById("loading-overlay").classList.add("hidden")}}),100)}catch(t){alert(t.message)}},renderTables:function(){this.renderStockBarsTable(),this.renderPiecesTable()},renderStockBarsTable:function(){const t=document.getElementById("stock-bars-table"),e=this.dataManager.getData();let i="\n      <thead>\n        <tr>\n          <th>Mod√®le</th>\n          <th>Longueur</th>\n          <th>Quantit√©</th>\n          <th></th>\n        </tr>\n      </thead>\n      <tbody>\n    ";for(const t in e.motherBars)for(const n of e.motherBars[t])i+=`\n          <tr data-model="${t}" data-length="${n.length}">\n            <td class="editable-cell" data-field="model">${t}</td>\n            <td class="editable-cell" data-field="length">${n.length}</td>\n            <td class="editable-cell" data-field="quantity">${n.quantity}</td>\n            <td class="delete-cell">\n              <button class="btn btn-sm btn-danger delete-btn">√ó</button>\n            </td>\n          </tr>\n        `;i+="</tbody>";const n=t.querySelector(".add-row");t.innerHTML=i,n&&t.appendChild(n)},renderPiecesTable:function(){const t=document.getElementById("pieces-table"),e=this.dataManager.getData();let i="\n      <thead>\n        <tr>\n          <th>Mod√®le</th>\n          <th>Longueur</th>\n          <th>Quantit√©</th>\n          <th></th>\n        </tr>\n      </thead>\n      <tbody>\n    ";for(const t in e.pieces)for(const n of e.pieces[t])i+=`\n          <tr data-model="${t}" data-length="${n.length}">\n            <td class="editable-cell" data-field="model">${t}</td>\n            <td class="editable-cell" data-field="length">${n.length}</td>\n            <td class="editable-cell" data-field="quantity">${n.quantity}</td>\n            <td class="delete-cell">\n              <button class="btn btn-sm btn-danger delete-btn">√ó</button>\n            </td>\n          </tr>\n        `;i+="</tbody>";const n=t.querySelector(".add-row");t.innerHTML=i,n&&t.appendChild(n)}},s={runAlgorithm:function(t,e){try{let i;if("compare"===t){const t=this.runFFDAlgorithm(e),n=this.runILPAlgorithm(e);i=this.compareAndSelectBest(t,n)}else if("greedy"===t||"ffd"===t)i=this.runFFDAlgorithm(e);else{if("ilp"!==t)throw new Error(`Type d'algorithme non reconnu: ${t}`);i=this.runILPAlgorithm(e)}return i}catch(t){throw console.error("Algorithm error:",t),t}},runFFDAlgorithm:function(t){const e=w.solveGreedyFFD(t.motherBars,t.pieces);return e.algorithmName="First-Fit Decreasing",e.algorithmType="ffd",e},runILPAlgorithm:function(t){const e=w.solveWithILP(t.motherBars,t.pieces);return e.algorithmName="Programmation Lin√©aire (ILP)",e.algorithmType="ilp",e},compareAndSelectBest:function(t,e){if(!t?.globalStats?.statistics?.utilizationRate||!e?.globalStats?.statistics?.utilizationRate)throw new Error("Les r√©sultats d'algorithme sont incomplets pour la comparaison.");const i=parseFloat(t.globalStats.statistics.utilizationRate),n=parseFloat(e.globalStats.statistics.utilizationRate),s=i>=n?"ffd":"ilp",a="ffd"===s?t:e;return a.comparison={ffdEfficiency:i,ilpEfficiency:n,bestAlgorithm:s,differencePercentage:Math.abs(i-n).toFixed(2)},a.bestAlgorithm=s,a.algorithmName="ffd"===s?"First-Fit Decreasing (meilleur)":"Programmation Lin√©aire (meilleur)",a.algorithmType="compare",a},processPattern:function(t){const e=t.pattern||t,i=t.count||1,n=e.cuts||e.pieces||[],s=e.remainingLength||e.waste||0,a=e.originalLength||e.totalLength+s,r={};n.forEach((t=>{r[t]=(r[t]||0)+1}));const o=Object.entries(r).sort(((t,e)=>e[0]-t[0])).map((([t,e])=>({length:parseInt(t),count:e}))),l=n.map(((t,e)=>({length:t,percentage:t/a*100,isLast:e===n.length-1&&0===s})));return{count:i,barLength:a,waste:s,cuts:o,visualPieces:l,wastePercentage:s/a*100}},calculateGlobalStats:function(t){const e=t.modelResults||{};let i=0,n=0,s=0;for(const t in e){const a=e[t];i+=a.rawData.usedBars.length;for(const t of a.rawData.usedBars)s+=t.originalLength,n+=t.remainingLength||t.waste||0}return{totalUsedBars:i,totalWaste:n,totalBarLength:s,totalEfficiency:s>0?(100*(1-n/s)).toFixed(2):"100.00"}},calculateModelStats:function(t){const e=t.rawData.usedBars;let i=0,n=0;for(const t of e)i+=t.originalLength,n+=t.remainingLength||t.waste||0;const s=i>0?(100*(1-n/i)).toFixed(2):"100.00";return{barCount:e.length,totalLength:i,wasteLength:n,efficiency:s}}},a={renderResults:function(t,e,i){if(i||(i=document.getElementById("results-container")),!t)return void this.renderErrorMessage(i,"Impossible de calculer les r√©sultats","L'algorithme n'a pas pu trouver de solution avec les donn√©es fournies.");const n=e.calculateGlobalStats(t);let s=this.renderGlobalSummary(t,n);s+=this.renderModelDetails(t,e),i.innerHTML=s},renderErrorMessage:function(t,e,i){t.innerHTML=`\n      <div class="error-message">\n        <h3>${e}</h3>\n        <p>${i}</p>\n      </div>\n    `},renderGlobalSummary:function(t,e){let i='\n      <div class="results-summary">\n        <h3>R√©sum√© global</h3>\n    ';return t.comparison&&(i+=this.renderComparisonSection(t.comparison,t.bestAlgorithm)),i+=`\n        <div class="stats-grid">\n          <div class="stat-card">\n            <div class="stat-label">Barres utilis√©es</div>\n            <div class="stat-value">${e.totalUsedBars}</div>\n          </div>\n          <div class="stat-card">\n            <div class="stat-label">Longueur totale barres m√®res</div>\n            <div class="stat-value">${e.totalBarLength} unit√©s</div>\n          </div>\n          <div class="stat-card">\n            <div class="stat-label">Chutes (total)</div>\n            <div class="stat-value">${e.totalWaste} unit√©s</div>\n          </div>\n          <div class="stat-card efficiency-card">\n            <div class="stat-label">Efficacit√©</div>\n            <div class="stat-value">${e.totalEfficiency}%</div>\n          </div>\n        </div>\n      </div>\n    `,i},renderComparisonSection:function(t,e){return`\n      <div class="algorithm-comparison">\n        <p class="comparison-result">\n          <strong>Algorithme choisi:</strong> ${"ffd"===e?"First-Fit Decreasing":"Programmation Lin√©aire"}\n          <span class="tag">${"ffd"===e?"FFD":"ILP"}</span>\n        </p>\n        <div class="algorithm-efficiencies">\n          <div class="efficiency-comparison ${"ffd"===e?"best":""}">\n            <div class="algorithm-name">First-Fit Decreasing</div>\n            <div class="efficiency-value">${t.ffdEfficiency}%</div>\n          </div>\n          <div class="efficiency-comparison ${"ilp"===e?"best":""}">\n            <div class="algorithm-name">Programmation Lin√©aire</div>\n            <div class="efficiency-value">${t.ilpEfficiency}%</div>\n          </div>\n        </div>\n        <p class="difference-info">\n          Diff√©rence d'efficacit√©: <strong>${t.differencePercentage}%</strong>\n        </p>\n      </div>\n    `},renderModelDetails:function(t,e){const i=t.modelResults||{};let n='\n      <h3 class="mb-3">D√©tails par mod√®le</h3>\n      <div class="model-results">\n    ';for(const t in i){const s=i[t],a=e.calculateModelStats(s);n+=this.renderModelCard(t,s,a,e)}return n+="</div>",n},renderModelCard:function(t,e,i,n){let s=`\n      <div class="model-card">\n        <div class="model-header">\n          <h3>Mod√®le: ${t}</h3>\n        </div>\n        <div class="model-content">\n          <div class="model-stats">\n            <div class="model-stat">\n              <div class="stat-label">Barres</div>\n              <div class="stat-value">${i.barCount}</div>\n            </div>\n            <div class="model-stat">\n              <div class="stat-label">Longueur totale</div>\n              <div class="stat-value">${i.totalLength} unit√©s</div>\n            </div>\n            <div class="model-stat">\n              <div class="stat-label">Chutes</div>\n              <div class="stat-value">${i.wasteLength} unit√©s</div>\n            </div>\n            <div class="model-stat">\n              <div class="stat-label">Efficacit√©</div>\n              <div class="efficiency-tag">${i.efficiency}%</div>\n            </div>\n          </div>\n          \n          <div class="cut-schemes">\n            <h4 class="mb-2">Sch√©mas de coupe</h4>\n    `;return e.layouts.forEach(((t,e)=>{const i=n.processPattern(t);s+=this.renderCutScheme(i,e)})),s+="\n          </div>\n        </div>\n      </div>\n    ",s},renderCutScheme:function(t,e){let i="";t.cuts.forEach((t=>{i+=`<span class="cut-count">${t.count}√ó</span>${t.length} `}));let n="";return t.visualPieces.forEach((t=>{const e=t.isLast?"last-piece":"";n+=`\n        <div class="cut-piece ${e}" \n             style="width: ${t.percentage}%" \n             title="${t.length}">\n          ${t.length}\n        </div>\n      `})),t.waste>0&&(n+=`\n        <div class="waste-piece" \n             style="width: ${t.wastePercentage}%" \n             title="Chute: ${t.waste}">\n          ${t.waste}\n        </div>\n      `),`\n      <div class="cut-scheme">\n        <div class="cut-scheme-header">\n          <strong>${t.count}√ó Sch√©ma #${e+1}</strong>\n          <span>Barre de ${t.barLength}</span>\n        </div>\n        <div class="cut-pieces">\n          Pi√®ces: ${i}\n        </div>\n        <div class="waste">\n          Chute: <span class="waste-value">${t.waste}</span>\n        </div>\n        <div class="cut-bar">\n          ${n}\n        </div>\n      </div>\n    `}};function r(t,e,i){let n=0,s=0,a=0,r=0,o=!1,l=!1,h=[],c=[],d=0,u=0;const p=new Map;for(const t of i)n+=t.length*t.quantity,p.set(t.length,t.quantity);for(const t of e)s+=t.length*t.quantity;if(t.rawData&&t.rawData.usedBars){const e=new Map;for(const i of t.rawData.usedBars){const t=i.cuts||[];for(const i of t){const t=e.get(i)||0;e.set(i,t+1)}a+=t.reduce(((t,e)=>t+e),0),r+=i.remainingLength||0}for(const[t,i]of e.entries()){const e=i-(p.get(t)||0);e>0?(o=!0,d+=e,h.push(`${e} pi√®ces de longueur ${t}`)):e<0&&(l=!0,u+=Math.abs(e),c.push(`${Math.abs(e)} pi√®ces de longueur ${t}`))}t.rawData.usedBars.reduce(((t,e)=>t+e.originalLength),0)}return{totalDemandLength:n,totalStockLength:s,totalUsedLength:a,totalWasteLength:r,utilizationRate:a>0&&t.rawData.usedBars.length>0?(a/t.rawData.usedBars.reduce(((t,e)=>t+e.originalLength),0)*100).toFixed(3):0,overproductionDetails:o?h.join(", "):null,underproductionDetails:l?c.join(", "):null,hasOverproduction:o,hasUnderproduction:l,totalOverproduced:d,totalUnderproduced:u}}var o=i(61),l=i.n(o);function h(t,e,i){const n={};for(const e of t.pieces)n[e]=(n[e]||0)+1;const s={...t,pieces:[],waste:t.waste,isModifiedPattern:!0};let a=!1;const r=[];for(const[t,i]of Object.entries(n)){const n=parseInt(t,10),o=e.get(n)||0,l=Math.min(i,o);for(let t=0;t<l;t++)s.pieces.push(n);if(l>0&&(e.set(n,o-l),r.push(`${l}x${n}`)),i>o){if(a=!0,s.originInfo&&s.originInfo.removedPieces)for(let t=0;t<i-l;t++)s.originInfo.removedPieces.push(n);s.waste+=(i-l)*n}}const o=t.pieces.reduce(((t,e)=>t+e),0),l=s.pieces.reduce(((t,e)=>t+e),0)/(o||1);return s.originalPatternIndex=t.originalPatternIndex||t.id||-1,s.originInfo={originalPieces:[...t.pieces],removedPieces:a?[]:null},l<.5&&s.pieces.length>0?(s.hasUsablePieces=!1,s):(s.isModified=a,s.hasUsablePieces=r.length>0,s)}function c(t){const e=[];for(const i of t)e.push({length:parseInt(i.length,10),quantity:parseInt(i.quantity,10)});return e.sort(((t,e)=>e.length-t.length)),e}function d(t){const e=[];for(const i of t)e.push({length:parseInt(i.length,10),quantity:parseInt(i.quantity,10)});return e.sort(((t,e)=>e.length-t.length)),e}function u(t,e){const i=[];for(const n of t){const t=n.length,s=p(e,t,3e3);if(s.forEach((e=>{e.stockLength=t,e.stockBarId=n.id||null})),i.push(...s),i.length>=1e4){console.warn("‚ö†Ô∏è Nombre maximum de patterns atteint (10000), certains patterns ignor√©s");break}}return i}function p(t,e,i=3e3){const n=t.filter((t=>t.length<=e));if(0===n.length)return[{pieces:[],waste:e,composition:{}}];const s=function(t,e,i){const n=new Map,s=[],a=new Set;return function e(r,o,l={}){const h=`${r}:${o}`;if(n.has(h))return n.get(h);if(o>=t.length||r<t[t.length-1].length){const t=(c=l,Object.entries(c).sort((([t],[e])=>parseInt(t)-parseInt(e))).map((([t,e])=>`${t}:${e}`)).join(","));if(!a.has(t)&&s.length<i){const e=[];for(const[t,i]of Object.entries(l))for(let n=0;n<i;n++)e.push(parseInt(t,10));s.push({pieces:e,waste:r,composition:{...l}}),a.add(t)}return[]}var c;const d=t[o],u=[];for(let t=Math.min(Math.floor(r/d.length),d.quantity);t>=0;t--){const i={...l};t>0&&(i[d.length]=(i[d.length]||0)+t);const n=e(r-t*d.length,o+1,i);if(u.push(...n),u.length>100)break}return n.set(h,u),u}(e,0),function(t,e,i,n){if(i.length>=n)return;const s=[...t].sort(((t,e)=>e.length-t.length));let a=e;const r={},o=[];for(const t of s){const e=Math.min(Math.floor(a/t.length),t.quantity);if(e>0){r[t.length]=e;for(let i=0;i<e;i++)o.push(t.length);a-=e*t.length}}o.length>0&&i.push({pieces:o,waste:a,composition:r}),function(t,e,i){for(let n=0;n<Math.min(t.length,5);n++){const s=t[n],a=Math.min(Math.floor(e/s.length),s.quantity);if(a>0){const t=Array(a).fill(s.length),n=e-a*s.length,r={[s.length]:a};i.push({pieces:t,waste:n,composition:r})}}}(t,e,i),function(t,e,i){const n=[...t].sort(((t,e)=>e.quantity-t.quantity)).slice(0,3);for(const t of n){const n=Math.min(Math.floor(e/t.length),t.quantity);if(n>0){const s=Array(n).fill(t.length),a=e-n*t.length,r={[t.length]:n};i.push({pieces:s,waste:a,composition:r})}}}(t,e,i)}(t,e,s,i),s}(n,e,i);return s.sort(((t,e)=>t.waste!==e.waste?t.waste-e.waste:e.pieces.length-t.pieces.length)),s.slice(0,i)}function g(t,e,i){console.log(`Tentative de r√©solution ILP avec ${i.length} patterns`);const{patterns:n,maxUsage:s}=function(t,e){console.log("G√©n√©ration de patterns sans risque de surproduction...");const i=u(t,e),n=[],s=new Map;for(const t of i){const i={};for(const e of t.pieces)i[e]=(i[e]||0)+1;let a=1/0,r=!1;for(const[t,n]of Object.entries(i)){r=!0;const i=parseInt(t,10),s=e.find((t=>t.length===i));if(!s){a=0;break}{const t=Math.floor(s.quantity/n);a=Math.min(a,t)}}a>0&&r&&(n.push(t),s.set(t,a))}return console.log(`${n.length} patterns s√ªrs g√©n√©r√©s (sur ${i.length} patterns initiaux)`),{patterns:n,maxUsage:s}}(t,e);if(0===n.length)return console.warn("‚ö†Ô∏è Aucun pattern s√©curis√© n'a pu √™tre g√©n√©r√©, utilisation de l'algorithme de secours"),f(i,t,e);const a=Math.min(800,n.length),r=[...n].sort(((t,e)=>t.waste-e.waste)).slice(0,a);console.log(`Utilisation des ${r.length} meilleurs patterns s√©curis√©s`);const o=function(t,e,i,n=null){const s={optimize:"bars",opType:"min",constraints:{},variables:{},ints:{}};for(const t of i)s.constraints[`demand_${t.length}`]={equal:t.quantity};const a=new Map;for(const t of e)a.has(t.length)?a.set(t.length,a.get(t.length)+t.quantity):a.set(t.length,t.quantity);for(const[t,e]of a.entries())s.constraints[`stock_${t}`]={max:e};for(let e=0;e<t.length;e++){const i=t[e],r=`pattern_${e}`;s.variables[r]={bars:1},s.ints[r]=1,n&&i.maxUsage&&(s.constraints[`max_usage_${e}`]={max:i.maxUsage},s.variables[r][`max_usage_${e}`]=1);const o={};for(const t of i.pieces)o[t]=(o[t]||0)+1;for(const[t,e]of Object.entries(o))s.variables[r][`demand_${t}`]=e;a.has(i.stockLength)&&(s.variables[r][`stock_${i.stockLength}`]=1)}return console.log("Mod√®le ILP cr√©√©:"),console.log("- Contraintes:",Object.keys(s.constraints).length),console.log("- Variables:",Object.keys(s.variables).length),s}(r,t,e,s);try{const t={timeout:1e4,strategy:0,msg:!0};console.log("Lancement du solveur ILP...");const e=l().Solve(o,t);if(console.log("Solution ILP obtenue:",e.feasible,"valeur:",e.result),e.feasible&&!isNaN(e.result)&&e.result>0){let t=!1;for(const i in e)if(i.startsWith("pattern_")&&!isNaN(e[i])&&e[i]>0){t=!0;break}if(t)return console.log("Solution ILP valide, utilisation de cette solution"),{method:"ILP",solution:e,patterns:r};console.warn("‚ö†Ô∏è Solution ILP sans patterns utilis√©s, utilisation du fallback")}else console.warn("‚ö†Ô∏è Solution ILP non valide, utilisation du fallback")}catch(t){console.error("Erreur lors de la r√©solution ILP:",t)}return console.log("Utilisation de l'algorithme de secours..."),f(r,t,e)}function f(t,e,i){console.log("Ex√©cution de la g√©n√©ration de colonnes...");const n={feasible:!0,result:0},s=new Map,a=new Map;console.log("\nüìã R√âSUM√â DES PI√àCES √Ä D√âCOUPER:"),console.log("‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ");for(const t of i)a.set(t.length,t.quantity),console.log(`  ‚Ä¢ Pi√®ce de longueur ${t.length}: ${t.quantity} unit√©s demand√©es`);console.log("‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n");const r=new Map;for(const t of e)r.has(t.length)?r.set(t.length,r.get(t.length)+t.quantity):r.set(t.length,t.quantity);const o=new Map,l=new Map;for(let e=0;e<t.length;e++){const i=t[e],n={};for(const t of i.pieces)n[t]=(n[t]||0)+1;let s=1/0;for(const[t,e]of Object.entries(n)){const i=parseInt(t,10),n=a.get(i)||0;e>0&&(s=Math.min(s,Math.floor(n/e)))}o.set(e,s),l.set(e,0)}let c=0;for(console.log("\nüîÑ D√âMARRAGE DES IT√âRATIONS"),console.log("‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ");Array.from(a.values()).some((t=>t>0))&&c<100;){c++,console.log(`\nüìå IT√âRATION ${c} :`);let i=[];for(const[t,e]of a.entries())e>0&&i.push(`${e}x${t}`);if(0===i.length){console.log("‚úÖ Toutes les pi√®ces ont √©t√© satisfaites!");break}console.log(`  ‚Ä¢ Demande restante: ${i.join(", ")}`);let d=null,u=-1/0,p=-1;for(let e=0;e<t.length;e++){const i=t[e];if((l.get(e)||0)>=(o.get(e)||0))continue;let n=0,s=!1;const r={};for(const t of i.pieces)r[t]=(r[t]||0)+1;for(const[t,e]of Object.entries(r)){const i=parseInt(t,10),r=a.get(i)||0;r>0&&(s=!0,n+=Math.min(e,r)*i)}let h=!0,c=0,g=0,f=!1;for(const[t,e]of Object.entries(r)){const i=parseInt(t,10),n=a.get(i)||0;e>n&&(c+=1,g+=e-n,0===n&&(f=!0,h=!1))}h?n-=2*i.waste+15*c+10*g+(f?200:0):n=-1e3,s&&n>u&&(u=n,d=i,p=e)}if(null===d){if(d=m(a,e),p=t.length,!d){console.warn(`‚ö†Ô∏è Impossible de satisfaire toute la demande √† l'it√©ration ${c}`);break}t.push(d),console.log(`Nouveau pattern g√©n√©r√© √† l'it√©ration ${c}`)}if(d){const e=d.stockLength,i=r.get(e)||0;if(i<=0){console.log(`‚ö†Ô∏è Plus de barres m√®res de longueur ${e} disponibles`),t.splice(p,1);continue}const o=h(d,a);if(!o.hasUsablePieces){console.log("  ‚Ä¢ Pattern ignor√© car aucune pi√®ce n'est n√©cessaire apr√®s adaptation");continue}r.set(e,i-1);const u=`modified_${p}_${c}`,g=`pattern_${u}`;n[g]=(n[g]||0)+1,l.set(p,(l.get(p)||0)+1),d=o,t[u]=o,s.has(u)?s.set(u,s.get(u)+1):s.set(u,1),n.result++}}const d=Array.from(a.entries()).filter((([t,e])=>e>0)).map((([t,e])=>({length:t,quantity:e})));if(d.length>0){console.warn(`‚ö†Ô∏è ${d.length} types de pi√®ces non satisfaites apr√®s column generation`);const t=function(t,e){console.log("R√©solution des pi√®ces restantes avec algorithme glouton");const i=new Map;for(const t of e)i.has(t.length)?i.set(t.length,i.get(t.length)+t.quantity):i.set(t.length,t.quantity);if(0===Array.from(i.values()).reduce(((t,e)=>t+e),0))return console.warn("‚ö†Ô∏è Plus aucune barre m√®re disponible pour les pi√®ces restantes"),{feasible:!1,result:0};Array.from(i.entries()).sort(((t,e)=>e[0]-t[0]))[0][0];const n=[];for(const e of t)for(let t=0;t<e.quantity;t++)n.push(e.length);n.sort(((t,e)=>e-t));const s=[],a={feasible:!0,result:0};for(const t of n){let e=!1;for(let i=0;i<s.length;i++)if(s[i].remainingSpace>=t){s[i].pieces.push(t),s[i].remainingSpace-=t,e=!0;break}if(!e){let e=null;for(const[n,s]of i.entries())s>0&&n>=t&&(null===e||n<e)&&(e=n);if(null===e){console.warn(`‚ö†Ô∏è Plus de barres disponibles pour la pi√®ce de longueur ${t}`);continue}i.set(e,i.get(e)-1),s.push({pieces:[t],remainingSpace:e-t,stockLength:e}),a.result++}}for(let t=0;t<s.length;t++)a[`pattern_extra_${t}`]=1;return a}(d,e);for(const[e,i]of Object.entries(t))"result"===e?n.result+=i:e.startsWith("pattern_")&&(n[e]=(n[e]||0)+i)}return console.log(`Column Generation termin√©e: ${n.result} barres utilis√©es`),{method:"ColumnGeneration",solution:n,patterns:t}}function m(t,e){e[0];const i=[];for(const[e,n]of t.entries())n>0&&i.push({length:parseInt(e,10),quantity:n});if(0===i.length)return null;i.sort(((t,e)=>e.length-t.length));let n=null,s=-1/0;for(const t of e){const e=t.length,a=v(i,e);if(a&&a.pieces.length>0){const t=(e-a.waste)/e;t>.5&&t>s&&(s=t,n=a,n.stockLength=e)}}return n}function v(t,e){const i=t.length,n=Array(e+1).fill(0),s=Array(e+1).fill().map((()=>[]));for(let a=0;a<i;a++){const i=t[a];for(let t=e;t>=i.length;t--)for(let e=1;e<=i.quantity;e++)if(t>=e*i.length){const a=n[t-e*i.length]+e*i.length;if(a>n[t]){n[t]=a,s[t]=[...s[t-e*i.length]];for(let n=0;n<e;n++)s[t].push(i.length)}}}const a=s[e],r=e-n[e],o={};for(const t of a)o[t]=(o[t]||0)+1;return{pieces:a,waste:r,composition:o}}function b(t,e){console.log("Utilisation de l'algorithme glouton simple");const i=new Map;for(const e of t)i.has(e.length)?i.set(e.length,i.get(e.length)+e.quantity):i.set(e.length,e.quantity);if(0===Array.from(i.values()).reduce(((t,e)=>t+e),0))return console.warn("‚ö†Ô∏è Aucune barre m√®re disponible"),{rawData:{usedBars:[],wasteLength:0,totalMotherBarsUsed:0,remainingPieces:e,motherBarLength:0},layouts:[]};const n=Array.from(i.keys()).sort(((t,e)=>e-t)),s=n[0],a=[];for(const t of e)for(let e=0;e<t.quantity;e++)a.push(t.length);a.sort(((t,e)=>e-t));const r=[];let o=-1;for(const t of a){let e=!1;for(let i=0;i<=o;i++)if(r[i].remainingSpace>=t){r[i].pieces.push(t),r[i].cuts.push(t),r[i].remainingSpace-=t,r[i].remainingLength-=t,e=!0;break}if(!e){let e=null;for(const s of n)i.get(s)>0&&s>=t&&(null===e||s<e)&&(e=s);if(null===e){console.warn(`‚ö†Ô∏è Plus de barres disponibles pour la pi√®ce de longueur ${t}`);continue}i.set(e,i.get(e)-1),o++,r[o]={id:o+1,pieces:[t],remainingSpace:e-t,originalLength:e,cuts:[t],remainingLength:e-t}}}let l=0;for(const t of r)l+=t.remainingSpace;const h={};for(const t of r){const e=t.pieces.slice().sort(((t,e)=>e-t)).join(",");h[e]?h[e].count++:h[e]={count:1,pieces:t.pieces.slice().sort(((t,e)=>e-t)),waste:t.remainingSpace,totalLength:t.originalLength-t.remainingSpace,cuts:t.pieces.slice().sort(((t,e)=>e-t)),remainingLength:t.remainingSpace,originalLength:t.originalLength}}const c=Object.values(h);return c.sort(((t,e)=>e.count-t.count)),{rawData:{usedBars:r,wasteLength:l,totalMotherBarsUsed:r.length,remainingPieces:[],motherBarLength:s},layouts:c}}function y(t,e,i){const{method:n,solution:s,patterns:a}=t;if(!a||0===a.length)return{rawData:{usedBars:[],wasteLength:0,totalMotherBarsUsed:0,remainingPieces:i,motherBarLength:e.length>0?e[0].length:0},layouts:[]};console.log(`Traitement des r√©sultats (m√©thode: ${n})`);const r=[],o=new Map;let l=0,h=1;for(const t of i)o.set(t.length,0);for(const[t,i]of Object.entries(s))if(t.startsWith("pattern_")&&!isNaN(i)&&i>0){let n;if(t.startsWith("pattern_extra_"))continue;n=t.startsWith("pattern_modified_")?t.replace("pattern_",""):parseInt(t.replace("pattern_",""),10);const s=a[n];if(!s){console.warn(`‚ö†Ô∏è Pattern ${n} non trouv√© dans la collection de patterns`);continue}s.isModifiedPattern&&s.originInfo&&(console.log(`Application du pattern modifi√© ${n}:`),console.log(`  ‚Ä¢ Pi√®ces d'origine: ${s.originInfo.originalPieces.join(", ")}`),console.log(`  ‚Ä¢ Pi√®ces conserv√©es: ${s.pieces.join(", ")}`),s.originInfo.removedPieces&&s.originInfo.removedPieces.length>0&&console.log(`  ‚Ä¢ Pi√®ces supprim√©es: ${s.originInfo.removedPieces.join(", ")}`));for(let t=0;t<i;t++){const t={id:h++,pieces:[...s.pieces],waste:s.waste||0,originalLength:s.stockLength||e[0].length,cuts:[...s.pieces],remainingLength:s.waste||0};r.push(t),l+=s.waste||0;for(const t of s.pieces)o.set(t,(o.get(t)||0)+1)}}const c=[];for(const t of i){const e=o.get(t.length)||0,i=t.quantity-e;i>0&&c.push({length:t.length,quantity:i})}if(c.length>0&&("ColumnGeneration"===n||s.greedy)){console.warn(`‚ö†Ô∏è Il reste ${c.length} types de pi√®ces non d√©coup√©es`);const t=b(e,c);r.push(...t.rawData.usedBars),l+=t.rawData.wasteLength,c.length=0}const d={};for(const t of r){const e=t.pieces.slice().sort(((t,e)=>e-t)).join(",");d[e]?d[e].count++:d[e]={count:1,pieces:t.pieces.slice().sort(((t,e)=>e-t)),waste:t.waste||t.remainingLength||0,totalLength:t.originalLength-(t.waste||t.remainingLength||0),cuts:t.pieces.slice().sort(((t,e)=>e-t)),remainingLength:t.waste||t.remainingLength||0,originalLength:t.originalLength}}const u=Object.values(d);return u.sort(((t,e)=>e.count-t.count)),{rawData:{usedBars:r,wasteLength:l,totalMotherBarsUsed:r.length,remainingPieces:c,motherBarLength:e.length>0?e[0].length:0},layouts:u}}function x(t,e,i){let n=0,s=0,a=0,r=0,o=!1,l=!1,h=[],c=[],d=0,u=0;const p=new Map;for(const t of i)n+=t.length*t.quantity,p.set(t.length,t.quantity);for(const t of e)s+=t.length*t.quantity;if(t.layouts&&t.layouts.length>0){const e=new Map;r=0;for(const i of t.layouts){const t=i.count||1,n=i.cuts||i.pieces||[];for(const i of n){const n=e.get(i)||0;e.set(i,n+t)}a+=n.reduce(((t,e)=>t+e),0)*t,r+=(i.remainingLength||i.waste||0)*t}let i=0;t.rawData&&t.rawData.usedBars&&(i=t.rawData.usedBars.reduce(((t,e)=>t+e.originalLength),0)),i>0&&(a/i*100).toFixed(3);for(const[t,i]of e.entries()){const e=i-(p.get(t)||0);e>0?(o=!0,d+=e,h.push(`${e} pi√®ces de longueur ${t}`)):e<0&&(l=!0,u+=Math.abs(e),c.push(`${Math.abs(e)} pi√®ces de longueur ${t}`))}o&&console.warn(`‚ö†Ô∏è SURPRODUCTION: ${d} pi√®ces au total`),l&&console.warn(`‚ö†Ô∏è PRODUCTION INCOMPL√àTE: ${u} pi√®ces manquantes`)}return{totalDemandLength:n,totalStockLength:s,totalUsedLength:a,totalWasteLength:r,utilizationRate:a>0&&t.rawData&&t.rawData.usedBars&&t.rawData.usedBars.length>0?(a/t.rawData.usedBars.reduce(((t,e)=>t+e.originalLength),0)*100).toFixed(3):0,overproductionDetails:o?h.join(", "):null,underproductionDetails:l?c.join(", "):null,hasOverproduction:o,hasUnderproduction:l,totalOverproduced:d,totalUnderproduced:u}}const w={solveGreedyFFD:function(t,e){const i={};let n={totalBarsUsed:0,totalWaste:0,totalRemainingPieces:0};for(const s in e){if(0===e[s].length||!t[s]||0===t[s].length)continue;const a={rawData:{usedBars:[],wasteLength:0,totalMotherBarsUsed:0,remainingPieces:[],motherBarLength:0},layouts:[],availableStock:{totalBars:0,bars:[]}};a.availableStock.bars=t[s].map((t=>({model:s,length:t.length,quantity:t.quantity})));const o=t[s][0].length;a.rawData.motherBarLength=o;let l=0;t[s].forEach((t=>{l+=t.quantity,a.availableStock.totalBars+=t.quantity}));const h=[];e[s].forEach((t=>{for(let e=0;e<t.quantity;e++)h.push(t.length)})),h.sort(((t,e)=>e-t));const c=[];let d=-1;for(const t of h){let e=!1;for(let i=0;i<=d;i++)if(c[i].remainingLength>=t){c[i].cuts.push(t),c[i].remainingLength-=t,e=!0;break}e||(l>0?(d++,l--,c.push({barId:d+1,cuts:[t],remainingLength:o-t,originalLength:o,model:s})):a.rawData.remainingPieces.push(t))}let u=0;c.forEach((t=>{u+=t.remainingLength})),a.rawData.usedBars=c,a.rawData.wasteLength=u,a.rawData.totalMotherBarsUsed=c.length,a.stats=r(a,t[s],e[s]),n.totalBarsUsed+=c.length,n.totalWaste+=u,n.totalRemainingPieces+=a.rawData.remainingPieces.length;const p={};c.forEach((t=>{const e=[...t.cuts].sort(((t,e)=>e-t)),i=e.join(",")+"_"+t.remainingLength;p[i]?p[i].count++:p[i]={pattern:t,count:1,pieces:e,cuts:e,waste:t.remainingLength||0,remainingLength:t.remainingLength||0,originalLength:t.originalLength,totalLength:t.originalLength-(t.remainingLength||0)}}));const g=Object.values(p);g.sort(((t,e)=>e.count-t.count)),a.layouts=g,console.log(`üìä Mod√®le ${s}: ${c.length} barres utilis√©es, taux d'utilisation: ${a.stats.utilizationRate}%`),i[s]=a}let s=0,a=0,o=0,l=0,h=0;for(const t in i){const e=i[t].stats;e&&(s+=e.totalStockLength||0,a+=e.totalDemandLength||0,o+=e.totalUsedLength||0,l+=e.totalWasteLength||0),i[t].rawData&&i[t].rawData.usedBars&&(h+=i[t].rawData.usedBars.reduce(((t,e)=>t+e.originalLength),0))}return n.statistics={totalStockLength:s,totalDemandLength:a,totalUsedLength:o,totalWasteLength:l,utilizationRate:h>0?(o/h*100).toFixed(3):0},console.log(`üìà GLOBAL: ${n.totalBarsUsed} barres utilis√©es, taux d'utilisation: ${n.statistics.utilizationRate}%`),{modelResults:i,globalStats:n}},solveWithILP:function(t,e,i=()=>{}){if(void 0===l())throw new Error("Le solveur jsLPSolver n'est pas d√©fini. Assurez-vous qu'il est correctement import√©.");const n={},s={totalBarsUsed:0,totalWaste:0,totalRemainingPieces:0};console.log("D√©but de l'ex√©cution ILP optimis√©e");for(const a in e){if(0===e[a].length||!t[a]||0===t[a].length)continue;i({step:`Traitement du mod√®le ${a}`,percentage:10});const r={rawData:{usedBars:[],wasteLength:0,totalMotherBarsUsed:0,remainingPieces:[],motherBarLength:0},layouts:[]};try{console.log(`Optimisation du mod√®le ${a}`);const n=c(t[a]),o=d(e[a]);if(0===o.length){console.log(`Mod√®le ${a} : aucune pi√®ce √† d√©couper`);continue}if(0===n.length){console.log(`Mod√®le ${a} : aucune barre m√®re disponible`);continue}i({step:`G√©n√©ration des patterns pour ${a}`,percentage:30});const l=u(n,o);console.log(`${l.length} patterns g√©n√©r√©s pour le mod√®le ${a}`),i({step:`R√©solution ILP pour ${a}`,percentage:70});const h=y(g(n,o,l),n,o);s.totalBarsUsed+=h.rawData.totalMotherBarsUsed,s.totalWaste+=h.rawData.wasteLength,s.totalRemainingPieces+=h.rawData.remainingPieces.length,r.rawData=h.rawData,r.layouts=h.layouts,console.log(`Mod√®le ${a} trait√© : ${h.rawData.totalMotherBarsUsed} barres utilis√©es`),h.rawData.remainingPieces.length>0&&console.warn(`‚ö†Ô∏è ${h.rawData.remainingPieces.length} pi√®ces non d√©coup√©es pour le mod√®le ${a}`)}catch(i){console.error(`Erreur lors du traitement du mod√®le ${a}:`,i);const n=b(c(t[a]),d(e[a]));r.rawData=n.rawData,r.layouts=n.layouts,s.totalBarsUsed+=n.rawData.totalMotherBarsUsed,s.totalWaste+=n.rawData.wasteLength,s.totalRemainingPieces+=n.rawData.remainingPieces.length,console.warn(`‚ö†Ô∏è Utilisation de l'algorithme de secours pour le mod√®le ${a}`)}const o=x(r,c(t[a]),d(e[a]));console.log(`üìä Mod√®le ${a}: ${r.rawData.totalMotherBarsUsed} barres utilis√©es, taux d'utilisation: ${o.utilizationRate}%`),n[a]={...r,stats:o},i({step:`Mod√®le ${a} termin√©`,percentage:100})}const a={totalDemandLength:0,totalStockLength:0,totalUsedLength:0,totalWasteLength:0,totalBarsLength:0};for(const t in n)n[t].stats&&(a.totalDemandLength+=n[t].stats.totalDemandLength,a.totalStockLength+=n[t].stats.totalStockLength,a.totalUsedLength+=n[t].stats.totalUsedLength,a.totalWasteLength+=n[t].stats.totalWasteLength,n[t].rawData&&n[t].rawData.usedBars&&(a.totalBarsLength+=n[t].rawData.usedBars.reduce(((t,e)=>t+e.originalLength),0)));return a.utilizationRate=a.totalBarsLength>0?(a.totalUsedLength/a.totalBarsLength*100).toFixed(3):0,console.log(`üìà GLOBAL: ${s.totalBarsUsed} barres utilis√©es, taux d'utilisation: ${a.utilizationRate}%`),{modelResults:n,globalStats:{...s,statistics:a}}}};document.addEventListener("DOMContentLoaded",(()=>{const i=t,n=s,r=a,o=i.initData();e.init({dataManager:i,algorithmService:n,resultsRenderer:r,data:o})}))})()})();</script></body></html>